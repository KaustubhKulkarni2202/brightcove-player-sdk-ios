<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Brightcove Native Player for iOS Reference</title>

	<link rel="stylesheet" href="css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1334)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="index.html">Brightcove Native Player for iOS </a>
			</h1>

			<p id="developer-home">
				<a href="index.html">Brightcove</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="hierarchy.html">Hierarchy</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">Brightcove Native Player for iOS Reference</h1>

					
					<div class="section section-overview index-overview">
						
						
						<h1>Brightcove Player SDK for iOS, version 6.9.0.1697</h1>

<h1>Table of Contents</h1>

<ol>
<li><a href="#Requirements">Requirements</a></li>
<li><a href="#SupportedPlatforms">Supported Platforms</a></li>
<li><a href="#Noteworthy">Noteworthy</a></li>
<li><a href="#FairPlay">FairPlay</a></li>
<li><a href="#SidecarSubtitles">Sidecar Subtitles</a></li>
<li><a href="#OfflinePlayback">Offline Playback</a></li>
<li><a href="#Installation">Installation</a></li>
<li><a href="#CocoaPods">CocoaPods</a></li>
<li><a href="#ManualInstallation">Manual Installaion</a></li>
<li><a href="#Imports">Imports</a></li>
<li><a href="#QuickStart">Quick Start</a></li>
<li><a href="#PlayerUI">Built-In PlayerUI Controls for iOS</a></li>
<li><a href="#TVPlayer">Built-In TV Player Controls for tvOS</a></li>
<li><a href="#AirPlay">AirPlay</a></li>
<li><a href="#Video360">Video 360</a></li>
<li><a href="#ArchitecturalOverview">Architectural Overview</a></li>
<li><a href="#PlayPauseSeek">Play, Pause, and Seek</a></li>
<li><a href="#PreloadingVideos">Preloading Videos</a></li>
<li><a href="#SourceSelection">Source Selection (HLS, MP4, HTTP/HTTPS)</a></li>
<li><a href="#PreferredBitrate">Setting a Preferred Bitrate</a></li>
<li><a href="#PlaybackInformation">Obtaining Content and Ad Playback Information</a></li>
<li><a href="#HandlingNetworkInterruptionsAndSlowdowns">Handling Network Interruptions and Slowdowns</a></li>
<li><a href="#Subclassing">Subclassing</a></li>
<li><a href="#Values">Values</a></li>
<li><a href="#PlaybackService">Retrieving Brightcove Assets Using the Playback Service</a></li>
<li><a href="#ViewStrategy">View Strategy</a></li>
<li><a href="#BackgroundVideo">Playing Video In The Background</a></li>
<li><a href="#PIP">Picture In Picture</a></li>
<li><a href="#ThumbnailSeeking">Thumbnail Seeking</a></li>
<li><a href="#TrackingErrors">Tracking Errors</a></li>
<li><a href="#CombiningPlugins">Combining Plugins</a></li>
<li><a href="#BufferOptimization">Buffer Optimization</a></li>
<li><a href="#AVPlayerViewController">Using an AVPlayerViewController with a BCOVPlaybackController</a></li>
<li><a href="#PlaybackAuthorizationService">Playback Authorization Service</a></li>
<li><a href="#VoiceOver">VoiceOver Support</a></li>
<li><a href="#ChinaDelivery">China Delivery</a></li>
<li><a href="#AVAudioSessionConfig">AVAudioSession Configuration</a></li>
<li><a href="#FAQ">Frequently Asked Questions</a></li>
<li><a href="#Support">Support</a></li>
</ol>


<h1>Requirements <a name="Requirements"></a></h1>

<ul>
<li>Xcode 11.0+</li>
<li>ARC</li>
</ul>


<h1>Supported Platforms <a name="SupportedPlatforms"></a></h1>

<p>Brightcove provides active support for the latest iOS SDK on the latest public release of the following iOS versions:</p>

<ul>
<li>iOS 12, 13 and 14</li>
<li>tvOS 12, 13 and 14</li>
</ul>


<p>Brightcove provides passive support for the following iOS versions:</p>

<ul>
<li>iOS 11.4.1</li>
<li>tvOS 11.4.1</li>
</ul>


<p>The Core SDK is localized for Arabic (ar), English (en), French (fr), German (de), Japanese (ja), Korean (ko), Spanish (es), Simplified Chinese (zh-Hans) and Traditional Chinese (zh-Hant). To gain the benefit of a localization, your app must also be localized for the same language and locale.</p>

<h1>Noteworthy <a name="Noteworthy"></a></h1>

<p>All SDK components - the core and plugin frameworks - are released with the same version number. When upgrading any single component, upgrade all components to the same version.</p>

<p><strong>CocoaPods Podspec names (since release 6.8.1)</strong></p>

<p>Release 6.8.1 of the Brightcove Player SDK updates the <code>Brightcove-Player-FreeWheel</code> and <code>Brightcove-Player-Omniture</code> podspecs to install the dynamic version of <code>BrightcovePlayerSDK</code>. A  <code>-static</code> podspec is now available for each plugin which will install the static version of <code>BrightcovePlayerSDK</code> along with the static version of the plugin framework itself. If there is no static version of a plugin, the dynamic version will be installed with the static version of <code>BrightcovePlayerSDK</code>.</p>

<table>
<thead>
<tr>
<th>Podspec Name  </th>
<th>  Framework Type  </th>
<th>  Dependency</th>
</tr>
</thead>
<tbody>
<tr>
<td>Brightcove-Player-Core </td>
<td> dynamic </td>
<td> -</td>
</tr>
<tr>
<td>Brightcove-Player-Core-static </td>
<td> static  </td>
<td> -</td>
</tr>
<tr>
<td>Brightcove-Player-FreeWheel </td>
<td> static </td>
<td> Brightcove-Player-Core for iOS,<br/>Brightcove-Player-Core for tvOS</td>
</tr>
<tr>
<td>Brightcove-Player-FreeWheel-static </td>
<td> static </td>
<td> Brightcove-Player-Core-static for iOS,<br/>Brightcove-Player-Core for tvOS</td>
</tr>
<tr>
<td>Brightcove-Player-GoogleCast </td>
<td> static </td>
<td> Brightcove-Player-Core</td>
</tr>
<tr>
<td>Brightcove-Player-GoogleCast-static </td>
<td> static </td>
<td> Brightcove-Player-Core-static</td>
</tr>
<tr>
<td>Brightcove-Player-IMA </td>
<td> dynamic </td>
<td> Brightcove-Player-Core</td>
</tr>
<tr>
<td>Brightcove-Player-IMA-static </td>
<td> dynamic </td>
<td> Brightcove-Player-Core-static</td>
</tr>
<tr>
<td>Brightcove-Player-Omniture </td>
<td> static </td>
<td> Brightcove-Player-Core</td>
</tr>
<tr>
<td>Brightcove-Player-Omniture-static </td>
<td> static </td>
<td> Brightcove-Player-Core-static</td>
</tr>
<tr>
<td>Brightcove-Player-Pulse </td>
<td> dynamic </td>
<td> Brightcove-Player-Core</td>
</tr>
<tr>
<td>Brightcove-Player-Pulse-static </td>
<td> dynamic </td>
<td> Brightcove-Player-Core-static</td>
</tr>
<tr>
<td>Brightcove-Player-SSAI </td>
<td> dynamic </td>
<td> Brightcove-Player-Core</td>
</tr>
<tr>
<td>Brightcove-Player-SSAI-static </td>
<td> static </td>
<td> Brightcove-Player-Core-static</td>
</tr>
</tbody>
</table>


<h2>FairPlay <a name="FairPlay"></a></h2>

<p>Support for playing FairPlay-protected videos is integrated into the core <em>BrightcovePlayerSDK</em> framework. Refer to the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/FairPlay.md">FairPlay guide</a> for full details about using FairPlay with the Brightcove Native Player SDK.</p>

<h2>Sidecar Subtitles <a name="SidecarSubtitles"></a></h2>

<p>Support for Sidecar Subtitles is integrated into the core <em>BrightcovePlayerSDK</em> framework. For full details about using Sidecar Subtitles with the Brightcove Native Player SDK, refer to the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/SidecarSubtitles.md">Sidecar Subtitles guide</a>.</p>

<h2>Video Downloads and Offline Playback <a name="OfflinePlayback"></a></h2>

<p>Since release 6.0.0, the Brightcove Native Player SDK allows you to download HLS videos, including those protected with FairPlay encryption, for playback later, whether online or offline. Refer to the app developer&rsquo;s guide for full details:</p>

<p><a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/OfflinePlayback.md">iOS App Developer&rsquo;s Guide to Video Downloading and Offline Playback with FairPlay</a></p>

<h1>Installation <a name="Installation"></a></h1>

<p>The Brightcove Player SDK provides two installation packages for iOS, a static library framework and a dynamic framework. Deployment is supported on iOS 11 and above.</p>

<p>The Brightcove Player SDK provides a dynamic framework to support tvOS 11.0 and above.</p>

<h2>CocoaPods <a name="CocoaPods"></a></h2>

<p>You can use <a href="https://cocoapods.org">CocoaPods</a> to add the Brightcove Player SDK to your project. You can find the latest <code>Brightcove-Player-Core</code> podspec <a href="https://github.com/brightcove/BrightcoveSpecs/tree/master/Brightcove-Player-Core">here</a>. The podspec supports both iOS and tvOS. CocoaPods 1.0 or newer is required and the latest version is recommended.</p>

<p>When using Brightcove CocoaPods in your project, add <code>source '</code>https://github.com/brightcove/BrightcoveSpecs.git'<code></code> to the start of your Podfile.</p>

<p>Specifying the default pod <code>Brightcove-Player-Core</code> will install the dynamic library framework. To install the static framework, append <code>-static</code> like this: <code>pod 'Brightcove-Player-Core-static'</code>.</p>

<p>Dynamic Framework example:</p>

<pre><code>source 'https://github.com/CocoaPods/Specs'
source 'https://github.com/brightcove/BrightcoveSpecs.git'

platform :ios, '11.0'
use_frameworks!

target 'MyVideoPlayer' do
  pod 'Brightcove-Player-Core'
end
</code></pre>

<p>Static Framework example:</p>

<pre><code>source 'https://github.com/CocoaPods/Specs'
source 'https://github.com/brightcove/BrightcoveSpecs.git'

platform :ios, '11.0'
use_frameworks!

target 'MyVideoPlayer' do
  pod 'Brightcove-Player-Core-static'
end
</code></pre>

<p>When updating your installation, it&rsquo;s a good idea to refresh the local copy of your BrightcoveSpecs repository so that you have the latest podspecs locally, just as you would update your CococaPods master repository. Typically if you run <code>pod update</code> in Terminal this will happen automatically, or alternatively you can update explicitly with <code>pod repo update</code>.</p>

<h2>Manual Installation <a name="ManualInstallation"></a></h2>

<p>To add the Brightcove Player SDK to your project manually:</p>

<ol>
<li>Download the latest zipped release from our <a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">release page</a>.</li>
<li>Add <code>BrightcovePlayerSDK.framework</code> to your project. Be sure to use the version corresponding to your target, iOS or tvOS.</li>
<li>On the &ldquo;Build Settings&rdquo; tab of your application target, ensure that the &ldquo;Framework Search Paths&rdquo; include the path to the framework. This should have been done automatically unless the framework is stored under a different root directory than your project.</li>
<li><p>On the &ldquo;General&rdquo; tab of your application target, add the following to the &ldquo;Frameworks, Libraries, Embedded Content&rdquo; section:</p>

<ul>
<li><code>BrightcovePlayerSDK.framework</code></li>
</ul>
</li>
<li>(<strong>Dynamic Framework</strong> only) On the &ldquo;General&rdquo; tab of your application target, add &lsquo;BrightcovePlayerSDK.framework&rsquo; to the &ldquo;Embedded Binaries&rdquo; section.</li>
<li>(<strong>Dynamic Framework</strong> only) On the &ldquo;Build Phases&rdquo; tab, add a &ldquo;Run Script&rdquo; phase with the command <code>bash ${BUILT_PRODUCTS_DIR}/${FRAMEWORKS_FOLDER_PATH}/BrightcovePlayerSDK.framework/strip-frameworks.sh</code>. Check &ldquo;Run script only when installing&rdquo;. This will remove unneeded architectures from the build, which is important for App Store submission.</li>
<li>(<strong>Static Framework</strong> only) On the &ldquo;Build Settings&rdquo; tab of your application target, add <code>-ObjC</code> to the &ldquo;Other Linker Flags&rdquo; build setting.</li>
<li>(<strong>Static Framework</strong> only) Locate the file <code>bcovpuiiconfont.ttf</code> within the <code>BrightcovePlayerSDK.framework</code> bundle and drag it directly into your project listing so that the font file becomes a part of your app. After dragging the file, be sure to add it to your app&rsquo;s build target when prompted to do so. Once your app is built, the font file should reside in the app bundle at the same level as the app&rsquo;s Info.plist file. The font file supplies some of the <code>BrightcovePlayerUI</code> interface elements, but it does not need to be listed in the plist itself.</li>
</ol>


<p>For reference, here are all the SDK components and corresponding URLs to help you locate and download the latest releases:</p>

<table>
<thead>
<tr>
<th>Component  </th>
<th> URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>Brightcove-Player-Core </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios/releases">https://github.com/brightcove/brightcove-player-sdk-ios/releases</a></td>
</tr>
<tr>
<td>Brightcove-Player-FreeWheel </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios-fw/releases">https://github.com/brightcove/brightcove-player-sdk-ios-fw/releases</a></td>
</tr>
<tr>
<td>Brightcove-Player-IMA </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ima/releases">https://github.com/brightcove/brightcove-player-sdk-ios-ima/releases</a></td>
</tr>
<tr>
<td>Brightcove-Player-Omniture </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios-omniture/releases">https://github.com/brightcove/brightcove-player-sdk-ios-omniture/releases</a></td>
</tr>
<tr>
<td>Brightcove-Player-Pulse </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios-pulse/releases">https://github.com/brightcove/brightcove-player-sdk-ios-pulse/releases</a></td>
</tr>
<tr>
<td>Brightcove-Player-SSAI </td>
<td> <a href="https://github.com/brightcove/brightcove-player-sdk-ios-ssai/releases">https://github.com/brightcove/brightcove-player-sdk-ios-ssai/releases</a></td>
</tr>
</tbody>
</table>


<h2>Imports <a name="Imports"></a></h2>

<p>The Brightcove Player SDK for iOS can be imported into code a few different ways:</p>

<pre><code>@import BrightcovePlayerSDK;
</code></pre>

<pre><code>#import &lt;BrightcovePlayerSDK/BrightcovePlayerSDK.h&gt;
</code></pre>

<pre><code>#import &lt;BrightcovePlayerSDK/[specific-class].h&gt;
</code></pre>

<h1>Quick Start <a name="QuickStart"></a></h1>

<p>Playing video with the Brightcove Player SDK for iOS:</p>

<pre><code>// ** Customize these values with your own account information **
static NSString * const kViewControllerPlaybackServicePolicyKey = @"...";
static NSString * const kViewControllerAccountID = @"...";
static NSString * const kViewControllerVideoID = @"...";

BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManager sharedManager];
id&lt;BCOVPlaybackController&gt; controller = [manager createPlaybackController];
self.controller = controller; // store this to a strong property
[self.view addSubview:controller.view];  

BCOVPlaybackService *service = [[BCOVPlaybackService alloc] initWithAccountId:kAccountId
                                                                    policyKey:kPlaybackServicePolicyKey];
[service findVideoWithVideoID:kViewControllerVideoID
                   parameters:nil
                   completion:^(BCOVVideo    *video,
                                NSDictionary *jsonResponse,
                                NSError      *error) {

                                    [controller setVideos:@[ video ]];
                                    [controller play];

                                }];
</code></pre>

<p>You need to keep the controller from being automatically released at the end of the method. A common way to do this is to store a reference to the controller in a strong instance variable.</p>

<h1>Built-in PlayerUI Controls <a name="PlayerUI"></a></h1>

<p>Since version 5.1.0, the Brightcove PlayerUI is fully integrated into the Core SDK framework. PlayerUI provides a fully-featured set of controls for playback and advertising, right out of the box.</p>

<p>The PlayerUI is quick to set up, displays ad controls for SSAI, Pulse and FreeWheel, and can be customized by creating your own layouts.</p>

<h2>Setting up PlayerUI Controls</h2>

<p>Follow the guidelines below for setting up the PlayerUI controls.</p>

<p>Create a property in your UIViewController to keep track of the <a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a>. The <a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a> will contain both the Playback Controller&rsquo;s view, and the controls view.</p>

<pre><code>// PlayerUI's Player View
@property (nonatomic) BCOVPUIPlayerView *playerView;
</code></pre>

<p>Create the <a href="Classes/BCOVPUIBasicControlView.html">BCOVPUIBasicControlView</a>, and then the <a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a>. This is where we associate the Playback Controller (and thus all the videos it plays) with the controls.</p>

<pre><code>// Create and configure Control View.
BCOVPUIBasicControlView *controlView = [BCOVPUIBasicControlView basicControlViewWithVODLayout];
self.playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController:self.playbackController options:nil controlsView:controlView];
// Add BCOVPUIPlayerView to your video view.
[self.videoView addSubview:self.playerView];
</code></pre>

<p>You&rsquo;ll need to set up the layout for the player view, you can do this with Auto Layout or the older Springs &amp; Struts approach.</p>

<p><strong>Springs &amp; Struts:</strong></p>

<p>Set the player view to match the video container from your layout (<code>videoView</code>) when it resizes.</p>

<pre><code>self.playerView.frame = self.videoView.bounds;
self.playerView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;  
</code></pre>

<p><strong>Auto Layout</strong></p>

<p>Set the <code>translatesAutoresizingMaskIntoConstraints</code> on <a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a> to <code>NO</code>.</p>

<pre><code>self.playerView.translatesAutoresizingMaskIntoConstraints = NO;
</code></pre>

<p>Then add the constraints for the layout; setting the top, right, left and bottom anchors of your <a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a> to equal that of <code>videoView</code></p>

<pre><code>[NSLayoutConstraint activateConstraints:@[
                                          [self.playerView.topAnchor constraintEqualToAnchor:self.videoView.topAnchor],
                                          [self.playerView.rightAnchor constraintEqualToAnchor:self.videoView.rightAnchor],
                                          [self.playerView.leftAnchor constraintEqualToAnchor:self.videoView.leftAnchor],
                                          [self.playerView.bottomAnchor constraintEqualToAnchor:self.videoView.bottomAnchor],
                                          ]];
</code></pre>

<p><strong>Reminder:</strong> The PlayerUI uses a small font file for various graphics. If you are installing the static framework, and not using CocoaPods, be sure to add the file <code>bcovpuiiconfont.ttf</code> from the <code>BrightcovePlayerSDK.framework</code> bundle directly to your project listing so that the font file is copied into the app bundle</p>

<h2><a href="Classes/BCOVPUIPlayerViewOptions.html">BCOVPUIPlayerViewOptions</a></h2>

<p>The <a href="Classes/BCOVPUIPlayerViewOptions.html"><code>BCOVPUIPlayerViewOptions</code></a> class allows you to customize some BCOVPlayerUI behavior at initialization. You can customize the following:</p>

<ul>
<li><code>jumpBackInterval</code> The time in seconds the player will seek back when the jump back button is pressed.</li>
<li><code>hideControlsInterval</code> The time in seconds after the last touch event, before the controls are hidden.</li>
<li><code>hideControlsAnimationDuration</code> The time in seconds it takes for the controls to animate to hidden.</li>
<li><code>showControlsAnimationDuration</code> The time in seconds it takes for the controls to animate to visible.</li>
<li><code>learnMoreButtonBrowserStyle</code> Setting that determines if tapping the &ldquo;Learn More&rdquo; button on an ad will display the clickthrough link in an external browser (default setting) or an internal browser.</li>
<li><code>presentingViewController</code> The UIViewController subclass to use for presenting other view controllers (like the closed caption selection view controller).</li>
<li><code>automaticControlTypeSelection</code> Whether or not you want the <code>BCOVPUIPlayerView</code> to pick a <code>BCOVPUIBasicControlView</code> type automatically based on the video type. If the video is VOD then <code>basicControlViewWithVODLayout</code> will be used, for live <code>basicControlViewWithLiveLayout</code> and for live DVR <code>basicControlViewWithLiveDVRLayout</code>. When this value is set to <code>YES</code> the <code>BCOVPUIBasicControlView</code> property passed into the <code>BCOVPUIPlayerView</code> initializer will be ignored.</li>
</ul>


<p>Options can be set using the following method:</p>

<pre><code>    BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManager sharedManager];
    id&lt;BCOVPlaybackController&gt; controller = [manager createPlaybackController];

    BCOVPUIPlayerViewOptions *options = [[BCOVPUIPlayerViewOptions alloc] init];
    options.jumpBackInterval = 5;

    BCOVPUIPlayerView *playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController:playbackController options:options];
</code></pre>

<h2>Supplied Layouts</h2>

<p>Three layouts are provided to support different types of video:</p>

<ul>
<li><p><code></code>BCOVPUIControlLayout<code> basicVODControlLayout</code> is a basic layout for general on-demand video streams.</p></li>
<li><p><code></code>BCOVPUIControlLayout<code> basicLiveControlLayout</code> is a layout for live video.</p></li>
<li><p><code></code>BCOVPUIControlLayout<code> basicLiveDVRControlLayout</code> is a layout for live video streams with DVR controls.</p></li>
</ul>


<p>You typically set a new layout immediatley after your <a href="Classes/BCOVPUIPlayerView.html"><code>BCOVPUIPlayerView</code></a> is created, but you can also set a new layout at any time. For example, you can set a new VOD layout like this:</p>

<pre><code>playerView.controlsView.layout = [BCOVPUIControlLayout basicVODControlLayout]
</code></pre>

<h2>Custom Layouts</h2>

<p>In addition to the default layouts, you can create your own highly customized layouts by instantiating a new <a href="Classes/BCOVPUIControlLayout.html"><code>BCOVPUIControlLayout</code></a> with your own design.</p>

<ol>
<li><p>First, create the controls that will go in your layout using <a href="Classes/BCOVPUIBasicControlView.html"><code>BCOVPUIBasicControlView</code></a> layoutViewWithControlFromTag:width:elasticity:<code>. Each control is packaged in a</code><a href="Classes/BCOVPUILayoutView.html"><code>BCOVPUILayoutView</code></a> that determines the control spacing.</p></li>
<li><p>You can set the <code>width</code> of each layout view to the default width (which is based on the type of control), or you can specify your own width.</p></li>
<li><p>Use the <code>elasticity</code> argument to determine how much the layout view containing the control reizes its width to fill the control bar.</p>

<ul>
<li>An elasticity of zero means the size of the layout view will be fixed.</li>
<li>An elasticity value greater than zero determines how much the layout view will grow to fill available space relative to all other elastic views in that control bar. A layout view with an elasticity value of 2.0 will grow twice as fast as a layout view with an elasticity value of 1.0. Typically a row of layout views will have at least one control with an elasticity greater than zero.</li>
</ul>
</li>
</ol>


<p>Here are examples of creating a variety of basic controls.</p>

<pre><code>// Create various standard layout views
// Standard play/pause button
BCOVPUILayoutView *playbackLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagButtonPlayback width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// Standard jump back button
BCOVPUILayoutView *jumpBackButtonLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagButtonJumpBack width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// Current time indicator
BCOVPUILayoutView *currentTimeLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagLabelCurrentTime width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// Time separator - typically the '/' character
BCOVPUILayoutView *timeSeparatorLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagLabelTimeSeparator width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// Video duration label
BCOVPUILayoutView *durationLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagLabelDuration width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// Slider bar used for scrubbing through the video
// The elasticity is set to 1 so that it can resize to fill available space
BCOVPUILayoutView *progressLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagSliderProgress width:kBCOVPUILayoutUseDefaultValue elasticity:1.0];

// Closed caption button
// This button is initially hidden ('removed'), and will be shown
// if closed captions or audio tracks are available.
BCOVPUILayoutView *closedCaptionLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagButtonClosedCaption width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];
closedCaptionLayoutView.removed = YES;

// The full-screen button
BCOVPUILayoutView *screenModeLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagButtonScreenMode width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];

// AirPlay button
// This button is initially hidden ('removed'), and will be shown
// if AirPlay devices are available.
BCOVPUILayoutView *externalRouteLayoutView = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagViewExternalRoute width:kBCOVPUILayoutUseDefaultValue elasticity:0.0];
externalRouteLayoutView.removed = YES;

// Empty view - used as a spacer
BCOVPUILayoutView     *spacerLayoutView1 = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagViewEmpty width:1.0 elasticity:1.0];

// Empty view - used as a spacer
BCOVPUILayoutView *spacerLayoutView2 = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagViewEmpty width:1.0 elasticity:1.0];

// Empty view - will have a custom UIImageView added as a subview
BCOVPUILayoutView *logoLayoutView1 = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagViewEmpty width:80.0 elasticity:1.0];

// Empty view - will have a custom UIImageView added as a subview
BCOVPUILayoutView *logoLayoutView2 = [BCOVPUIBasicControlView layoutViewWithControlFromTag:BCOVPUIViewTagViewEmpty width:36.0 elasticity:0.0];
</code></pre>

<p>Note that you can also create an empty layout view, into which you can place your own view (logo, control, nothing, etc.). This code shows how to place a <code>UIImage</code> logo inside the logoLayoutView1 we created above.</p>

<pre><code>// Create logo image inside an image view for display in control bar.
UIImage *logoImage1 = [UIImage imageNamed:@"myLogo"];
UIImageView *logoImageView1 = [[UIImageView alloc] initWithImage:logoImage1];

logoImageView1.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;
logoImageView1.contentMode = UIViewContentModeScaleAspectFit;
logoImageView1.frame = logoLayoutView1.frame;

// Add image view to our empty layout view.
[logoLayoutView1 addSubview:logoImageView1];
</code></pre>

<p>Now that there are various controls packaged in layout views, they are ordered into arrays, each of wihch represents a single line of controls, i.e. a control bar. Note that you can have different layouts for portrait and landscape orientations, so you will typically set up two different arrays of control bars.</p>

<p>In the standard layout for landscape orientation, controls are arranged in a single array, and then that array is stored in another array representing the entire set of controls.</p>

<pre><code>        NSArray *standardLayoutLine1 = @[ playbackLayoutView, jumpBackButtonLayoutView, currentTimeLayoutView, timeSeparatorLayoutView, durationLayoutView, progressLayoutView, spacerLayoutView1, logoLayoutView1, spacerLayoutView2, closedCaptionLayoutView, screenModeLayoutView, externalRouteLayoutView ];
        NSArray *standardLayoutLines = @[ standardLayoutLine1 ];
</code></pre>

<p>In the compact layout for portrait orientation, two arrays of controls are created, one for each line. These arrays are packaged into another array representing the compact layout.</p>

<p>Note that the exact same objects are used for most of the controls in each layout. When this is done, and you switch between portrait and landscape orientations, the object will be moved to its new position using smooth animation.</p>

<pre><code>        NSArray *compactLayoutLine1 = @[ currentTimeLayoutView, progressLayoutView, durationLayoutView ];
        NSArray *compactLayoutLine2 = @[ playbackLayoutView, jumpBackButtonLayoutView, spacerLayoutView1, closedCaptionLayoutView, screenModeLayoutView, externalRouteLayoutView, logoLayoutView2 ];
        NSArray *compactLayoutLines = @[ compactLayoutLine1, compactLayoutLine2 ];
</code></pre>

<p>Finally, now that there are two layout configurations (one for full width, and one for compact width), you can create a new <a href="Classes/BCOVPUIControlLayout.html"><code>BCOVPUIControlLayout</code></a> object, and set it in the player&rsquo;s control view.</p>

<pre><code>        BCOVPUIControlLayout *customLayout = [[BCOVPUIControlLayout alloc] initWithStandardControls:standardLayoutLines compactControls:compactLayoutLines];
        playerView.controlsView.layout = customLayout;
</code></pre>

<p>If you have controls that you need to show or hide frequently, you can set the <code>removed</code> property on that control&rsquo;s layout view. When you have changed your controls, call <code>setNeedsLayout</code> on the playerView&rsquo;s controlView:</p>

<pre><code>    logoLayoutView1.removed = YES;
    [playerView.controlsView setNeedsLayout];
</code></pre>

<p>You can also customize several general <a href="Classes/BCOVPUIControlLayout.html"><code>BCOVPUIControlLayout</code></a> properties:</p>

<ul>
<li><code>controlBarHeight</code> sets the size of each row of controls.</li>
<li><code>horizontalItemSpacing</code> sets the spacing between each <a href="Classes/BCOVPUILayoutView.html"><code>BCOVPUILayoutView</code></a> in each control bar.</li>
<li><code>compactLayoutMaximumWidth</code> determines which set of controls is used. If the control view is smaller than <code>compactLayoutMaximumWidth</code>, the compact control set will be used, otherwise the standard controls will be used.</li>
</ul>


<p>To change the set of controls that are displayed, you must create and install a new <a href="Classes/BCOVPUIControlLayout.html"><code>BCOVPUIControlLayout</code></a>. New controls can be installed at any time.</p>

<h2>More Customization Examples</h2>

<p>For more examples of PlayerUI customization, you can look at the sample code in the PlayerUI folder of the BrightcoveOS GitHub repository:</p>

<p><a href="https://github.com/BrightcoveOS/ios-player-samples">[https://github.com/BrightcoveOS/ios-player-samples](https://github.com/BrightcoveOS/ios-player-samples)</a></p>

<h1>Built-in TV Player Controls for tvOS <a name="TVPlayer"></a></h1>

<p>The Brightcove Native Player SDK includes built-in controls for playback in tvOS on Apple TV. For full details about using the built-in TV Player UI with the Brightcove Native Player SDK, see our <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/TVPlayer.md">TV Player guide</a>.</p>

<h1>AirPlay <a name="AirPlay"></a></h1>

<p>Enable AirPlay functionality by setting the <code>setAllowsExternalPlayback</code> property on your <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> to <code>true</code>. The AirPlay button will be displayed in the playback controls if AirPlay devices are found on your network.</p>

<p>Currently, IMA is the only ad plugin that supports AirPlay and only when using pre-roll and/or post-roll ads. Using AirPlay with the Pulse, SSAI or FreeWheel ad plugins may result in unexpected behavior.</p>

<p>If you also want to support AirPlay 2 and allow for multiple devices to be selected for audio output you will have to do a few additional things. First, you&rsquo;ll need to configure AVAudioSession so that you can set the <code>routeSharingPolicy</code>. For example:</p>

<pre><code>[AVAudioSession.sharedInstance setCategory:AVAudioSessionCategoryPlayback mode:AVAudioSessionModeMoviePlayback routeSharingPolicy:AVAudioSessionRouteSharingPolicyLongForm options:0 error:nil];
</code></pre>

<p>You will also need to configure at least one playback command via <code>MPRemoteCommandCenter</code>. At the very least you&rsquo;ll want to configure both the <code>pauseCommand</code> and <code>playCommand</code>. For Example:</p>

<pre><code>MPRemoteCommandCenter *center = MPRemoteCommandCenter.sharedCommandCenter;

[center.pauseCommand addTargetWithHandler:^MPRemoteCommandHandlerStatus(MPRemoteCommandEvent * _Nonnull event) {
[self.playbackController pause];
return MPRemoteCommandHandlerStatusSuccess;
}];

[center.playCommand addTargetWithHandler:^MPRemoteCommandHandlerStatus(MPRemoteCommandEvent * _Nonnull event) {
[self.playbackController play];
return MPRemoteCommandHandlerStatusSuccess;
}];
</code></pre>

<p>Devices that are running iOS 11 or later will take advantage of <code>AVRoutePickerView</code> which has two delegate methods. These delegate methods are passed through to <a href="Protocols/BCOVPUIPlayerViewDelegate.html"><code>BCOVPUIPlayerViewDelegate</code></a>. The methods are:</p>

<pre><code>- (void)routePickerViewWillBeginPresentingRoutes:(AVRoutePickerView *)routePickerView;
- (void)routePickerViewDidEndPresentingRoutes:(AVRoutePickerView *)routePickerView;
</code></pre>

<p>The <code>AVRouteDetector</code> used to discover AirPlay routes is available on the <a href="Classes/BCOVPUIBasicControlView.html"><code>BCOVPUIBasicControlView</code></a> object so you can enable or disable its <code>routeDetectionEnabled</code> property as needed.</p>

<p>Per Apple&rsquo;s documentation: &ldquo;<em>Route detection significantly increases power consumption and must be turned off when it&rsquo;s no longer needed.</em>&rdquo;</p>

<pre><code>// Objective-C
self.playerView.controlsView.routeDetector.routeDetectionEnabled = NO;

// Swift
playerView?.controlsView.routeDetector.isRouteDetectionEnabled = false
</code></pre>

<p>For more information on incorporating AirPlay 2 into your app please see the <a href="https://developer.apple.com/documentation/avfoundation/media_playback_and_selection/getting_airplay_2_into_your_app?language=objc">Getting Airplay 2 into Your App</a> documentation.</p>

<p><strong>Important Note: AirPlay 2 is only supported on devices running iOS 11.4 or later.</strong></p>

<h1>Video 360 <a name="Video360"></a></h1>

<p>The Native Player SDK includes support for interactively displaying 360 degree spherical videos. 360 videos should be tagged with a &ldquo;projection&rdquo; field property containing the value &ldquo;equirectangular&rdquo;. These videos will be loaded and played in the same way as other videos, but they will be displayed in an OpenGL ES layer instead of an AVPlayerLayer.</p>

<p>Note: &ldquo;equirectangular&rdquo; is the only projection format supported for 360 source videos at this time.</p>

<p>The PlayerUI also has built-in support for Video 360, providing default panning gestures, gyroscopic motion detection for the view, and a new Video 360 button that appears when a Video 360 asset is playing. This button appears only on iPhones, and lets you toggle betwen the normal view and a &ldquo;VR Goggles&rdquo; view, where the screen is split in two, with the same scene rendered for each eye so that the device can be used in a head-mounted configuration. On iPads no Video 360 button is needed because there is only a single mode of operation: motion detection with panning gesture support.</p>

<p>Supporting Video 360 is as simple as playing a video. When the &ldquo;projection&rdquo; field property is detected, the Native Player SDK will automatically handle setting up and displaying the video in OpenGL ES, and installing the Video 360 button when appropriate.</p>

<p>If you are playing 360 videos outside of Video Cloud, be sure to add a &ldquo;projection&rdquo; property to the <a href="Classes/BCOVVideo.html"><code>BCOVVideo</code></a> object with the value &ldquo;equirectangular&rdquo;.</p>

<p>To provide the best user experience with the VR Goggles mode, you should use a <a href="Protocols/BCOVPUIPlayerViewDelegate.html"><code>BCOVPUIPlayerViewDelegate</code></a> method to detect when this mode is enabled. This allows you to force the device into landscape orientation (since that is the only orientation that makes sense for a VR Goggles view).</p>

<p>The following code shows how you could handle a forced orientation change when switching back and forth between a normal 360 view, and VR Goggles mode.</p>

<pre><code>    // Set this to YES when displaying a VR goggles video
    @property (nonatomic) BOOL landscapeOnly;

    // UIViewController override:
   // Lets us control the orientation of the device
    - (UIInterfaceOrientationMask)supportedInterfaceOrientations
    {
        if (self.landscapeOnly)
        {
            return UIInterfaceOrientationMaskLandscape;
        }

        return UIInterfaceOrientationMaskAll;
    }

    // BCOVPUIPlayerViewDelegate method
    - (void)didSetVideo360NavigationMethod:(BCOVPUIVideo360NavigationMethod)navigationMethod
                           projectionStyle:(BCOVVideo360ProjectionStyle)projectionStyle
    {
        switch (projectionStyle)
        {
            case BCOVVideo360ProjectionStyleNormal:
                NSLog(@"BCOVVideo360ProjectionStyleNormal");
                self.landscapeOnly = NO;
                break;

            case BCOVVideo360ProjectionStyleVRGoggles:
                NSLog(@"BCOVPUIVideo360NavigationDeviceMotionTracking");

                self.landscapeOnly = YES;

                {
                    UIDeviceOrientation currentDeviceOrientation = [UIDevice currentDevice].orientation;
                    switch (currentDeviceOrientation)
                    {
                        case UIDeviceOrientationLandscapeLeft:
                        case UIDeviceOrientationLandscapeRight:
                            // all good
                            break;
                        default:
                        {
                            // switch orientation
                            NSNumber *value = [NSNumber numberWithInt:UIInterfaceOrientationLandscapeLeft];
                            [[UIDevice currentDevice] setValue:value forKey:@"orientation"];
                            break;
                        }
                    }
                }
                break;
        }

        [UIViewController attemptRotationToDeviceOrientation];
    }
</code></pre>

<p>The PlayerUI will install gestures to handle navigation around the 360 video, but if you are using your own controls you can set the view parameters of the virtual camera yourself. The <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> protocol&rsquo;s <code>viewProjection</code> property lets you set these parameters. The property is a <a href="Classes/BCOVVideo360ViewProjection.html"><code>BCOVVideo360ViewProjection</code></a> class with basic virtual camera settings like <code>pan</code>, <code>tilt</code>, and <code>zoom</code>. To change settings, make a copy of the current instance, change the settings on the new instance, and then assign it back to the <code>viewProjection</code> property.</p>

<h2>Architectural Overview <a name="ArchitecturalOverview"></a></h2>

<p><img src="architecture01.png" alt="Architectural Overview 1" /></p>

<p>The entry point to the Brightcove Player SDK for iOS is the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlayerSDKManager.h">[<code>BCOVPlayerSDKManager</code>](Classes/BCOVPlayerSDKManager.html)</a> singleton object. This Manager handles registration of plugin components and some other housekeeping tasks, but it primarily serves as an object factory. Your app&rsquo;s view controller obtains a reference to the Manager, and uses it to create a <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h">[<code>BCOVPlaybackController</code>](Protocols/BCOVPlaybackController.html)</a>. The playback controller&rsquo;s <code>view</code> property exposes a UIView containing the AVPlayerLayer object that ultimately presents your video content on the screen. The playback controller also accepts a <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L667-L793">[<code>BCOVPlaybackControllerDelegate</code>](Protocols/BCOVPlaybackControllerDelegate.html)</a>, which you can implement to respond to various video playback events.</p>

<p>The playback controller offers methods and properties to affect playback of the current video. However, internally, the playback controller delegates to a <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackSession.h">[<code>BCOVPlaybackSession</code>](Protocols/BCOVPlaybackSession.html)</a> object. Playback sessions do the actual work of preparing and playing video content, and contain the video&rsquo;s metadata and <code>AVPlayer</code>. The playback controller has mechanisms to advance from the current playback session to the next playback session, either automatically at the end of a video, or manually with a method call. Once the playback controller has advanced to a new session, the previous session is discarded and cannot be used again.</p>

<p>There are two other elements of the playback controller: a <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackSessionProvider.h">[<code>BCOVPlaybackSessionProvider</code>](Protocols/BCOVPlaybackSessionProvider.html)</a>, and a list of <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L538-L655">[<code>BCOVPlaybackSessionConsumer</code>](Protocols/BCOVPlaybackSessionConsumer.html)</a>s. As the name would suggest, the playback session provider is responsible for creating playback sessions and delivering them to the playback controller. The playback controller then delivers the session to each of the playback session consumers in the list. Both the session provider and session consumer APIs are designed for use by plugin developers, and are not detailed in this document.</p>

<p>In addition to the playback functionality provided by the classes described above, there are a handful of value classes. These are used to hold data specific to the Player SDK for iOS. Each of these is described in more detail in its own section below.</p>

<h2>Play, Pause, and Seek <a name="PlayPauseSeek"></a></h2>

<p>The Brightcove Player SDK for iOS provides play, pause, and seek methods on the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a>. <strong>It is important to use these methods instead of using the AVPlayer equivalent.</strong> In their default implementations, these objects forward the calls directly to the corresponding method on the AVPlayer. However, if you are using plugins, they may override the default behavior to add functionality. For example, if using an advertising plugin, calling <a href="Protocols/BCOVPlaybackController.html#//api/name/play"><code>[BCOVPlaybackController play]</code></a> the first time might cause pre-roll to play before starting the content. To find out more about how a plugin may override the default behavior, please refer to each plugin README.md or by checking for a category extension on <a href="Classes/BCOVSessionProviderExtension.html"><code>BCOVSessionProviderExtension</code></a> that the plugin may add.</p>

<p><em>Calling play, pause, or seek on the AVPlayer directly may cause undefined behavior.</em></p>

<h2>Preloading Videos <a name="PreloadingVideos"></a></h2>

<p>If desired you may choose to preload upcoming videos in a playlist. One possible approach is to double-buffer a list of videos using two playback controllers, for example:</p>

<ol>
<li>Initialize two playback controllers</li>
<li>Set up your player view and assign one of the two playback controllers to the playerView&rsquo;s playbackController property (now your active playback controller)</li>
<li>Once your playlist is ready assign the playlist (or just the videos array property) to a property as we&rsquo;ll need to access each video separately</li>
<li>Get the first video in the videos array and give it to the active playback controller (<code>[self.playbackController1 setVideos:@[self.videos.firstObject]]</code>)</li>
<li>Utilizing the <code>playbackController:didProgressTo:</code> delegate method of the playback controller determine if the current video has progressed far enough to where you want to begin preloading the next video</li>
<li>Once you determine it&rsquo;s time to preload get the next video in the videos array and set it on the alternate playback controller</li>
<li>Once the current video has completed set the playbackController on the playerView to the alternate playback controller</li>
<li>Rinse and repeat steps 5-7</li>
</ol>


<p>For a working example you may download our <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoPreloading">VideoPreloading</a> sample app from our <a href="https://github.com/BrightcoveOS/ios-player-samples">Player Samples</a> repository.</p>

<p><strong>Note: You might want to take into account the amount of memory available on the client&rsquo;s device and speed of their connection. If they are not on Wifi, preloading a video may affect the current video&rsquo;s network resources.</strong></p>

<h2>Source Selection (HLS, MP4, HTTP/HTTPS) <a name="SourceSelection"></a></h2>

<p>The Brightcove Player SDK for iOS provides clients the ability to attach multiple url and delivery types (<a href="Classes/BCOVSource.html"><code>BCOVSource</code></a>) to a single video (<a href="Classes/BCOVVideo.html"><code>BCOVVideo</code></a>). For example, if your videos are being retrieved by the Playback Service, there may be a mix of HLS or MP4 renditions for a single video, along with HTTP and HTTPS versions.  Which one of these sources that get selected is determined by a source selection policy block. The default source selection policy will select the first HLS <a href="Classes/BCOVSource.html"><code>BCOVSource</code></a> on each <a href="Classes/BCOVVideo.html"><code>BCOVVideo</code></a>, with HTTPS sources preferred over HTTP.</p>

<p>Source selection can be overridden by creating a <a href="Classes/BCOVBasicSessionProviderOptions.html"><code>BCOVBasicSessionProviderOptions</code></a> and using it to create a <a href="Classes/BCOVBasicSessionProvider.html"><code>BCOVBasicSessionProvider</code></a>. For example:</p>

<pre><code>BCOVPlayerSDKManager *sdkManager = [BCOVPlayerSDKManager sharedManager];

BCOVBasicSessionProviderOptions *options = [[BCOVBasicSessionProviderOptions alloc] init];    
options.sourceSelectionPolicy = &lt;policy&gt;

id&lt;BCOVPlaybackSessionProvider&gt; provider = [sdkManager createBasicSessionProviderWithOptions:options];
idBCOVPlaybackController playbackController = [sdkManager createPlaybackControllerWithSessionProvider:provider viewStrategy:nil];
</code></pre>

<p>If this default selection policy does not work for you, there are a few alternatives to selecting a source:</p>

<ul>
<li><p>If retrieving videos from Video Cloud via the Playback Service, before calling <code>[BCOVPlaybackController setVideos:]</code>, use the update method on the <code>BCOVVideo</code> to only contain the source you want (see the &ldquo;Values&rdquo; section for more info).</p></li>
<li><p>You can use the helper method <code>[BCOVBasicSourceSelectionPolicy sourceSelectionHLSWithScheme:scheme]</code> to create a policy that prefers a specific scheme. This is the method used to create the default source selection policy that prefers HTTPS.</p></li>
<li><p>Similar to updating the video object, you may also implement your own source selection block.</p>

<pre><code>  options.sourceSelectionPolicy = ^ BCOVSource *(BCOVVideo *video) {

     &lt;Check video.sources for source&gt;
     &lt;Return source&gt;

  };
</code></pre></li>
</ul>


<p>Please be aware there are App Store limitations regarding the use of MP4 videos. Check the latest Apple Developer information for details.</p>

<h2>Setting a Preferred Bitrate <a name="PreferredBitrate"></a></h2>

<p>The Brightcove Player SDK for iOS provides a way to set the preferred bitrate for a video. You can create a <a href="Classes/BCOVPreferredBitrateConfig.html">BCOVPreferredBitrateConfig</a> object that contains your desired bitrate options, along with some configuration for the view controller which is created to display the options.</p>

<p>The title for the menu is optional. The bitrate options are an array of NSDictionary&rsquo;s with each dictionary having one key:value pair. The key will be used as the option name, and the value is an NSNumber with the bitrate for that option in bps (bits per second). The bitrates you enter are values that can be mapped to bitrates of the renditions of your video assets. You can learn more about renditions in <a href="https://studio.support.brightcove.com/admin/ingest-profiles-best-practices.html">Ingest Profiles Best Practices</a>.</p>

<p>Here is an example:</p>

<pre><code>BCOVPUIPlayerViewOptions *options = [[BCOVPUIPlayerViewOptions alloc] init];
options.preferredBitrateConfig = [BCOVPreferredBitrateConfig configWithMenuTitle:@"Select an Option" andBitrateOptions:@[@{@"Auto":@(0)}, @{@"Setting 1":@(aBitrateValue)}, @{@"Setting 2":@(aBitrateValue)}]];
</code></pre>

<p>When the end-user selects one of the options, the <a href="https://developer.apple.com/documentation/avfoundation/avplayeritem/1388541-preferredpeakbitrate">preferredPeakBitRate</a> property of the current AVPlayerItem will be set to the option&rsquo;s value. If the video is in a playlist, the next video played will also have the preferredPeakBitRate value set.</p>

<p>After setting a non-zero value for <a href="https://developer.apple.com/documentation/avfoundation/avplayeritem/1388541-preferredpeakbitrate">preferredPeakBitRate</a> you may not notice a difference in quality until AVPlayer has reached the end of its current buffered cache.</p>

<p>You may additionally use the <code>configWithMenuTitle:bitrateOptions:andIndexofInitialSelection:</code> initializer that provides the ability to set the index of your preferred initial value. The index should correlate to the index of the desired option in the <code>bitrateOptions</code> array.</p>

<p>You may additionally use the <code>setPreferredPeakBitRate:</code> method on your <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> object to programatically set the preferred bitrate for the current and future sessions.</p>

<p>NOTE: End-users must be given a way to return to the default value (0) of <a href="https://developer.apple.com/documentation/avfoundation/avplayeritem/1388541-preferredpeakbitrate">preferredPeakBitRate</a>. You can do this by providing an option with a bitrate value of 0. If you do not provide a bitrate option of 0 an &ldquo;Automatic&rdquo; option will be appended to your list of options for the end-user.</p>

<p>Please see Apple&rsquo;s documentation on <a href="https://developer.apple.com/documentation/avfoundation/avplayeritem/1388541-preferredpeakbitrate">preferredPeakBitRate</a> for more information.</p>

<h2>Obtaining Content and Ad Playback Information <a name="PlaybackInformation"></a></h2>

<p>The Brightcove Player SDK for iOS provides two mechanisms for obtaining playback information. The playback controller provides a delegate property that implements <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L667-L793">[<code>BCOVPlaybackControllerDelegate</code>](Protocols/BCOVPlaybackControllerDelegate.html)</a>. A delegate can implement these optional methods to get notified of playback metadata like progress, duration changes, and other events. If an ad plugin is installed, it may also use this delegate to provide information about <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVAdvertising.h#L120-L192">ad playback</a>. The <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L630-L641">lifecycle event</a> delegate method provides events to signal changes in playback state. For example, when a player goes from the paused state to the playing state, the lifecycle event delegate method will be called with the <code>kBCOVPlaybackSessionLifecycleEventPlay</code> event. The default Lifecycle events are declared in <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/master/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackSession.h">[<code>BCOVPlaybackSession</code>](Protocols/BCOVPlaybackSession.html)</a>. Plugins provided by Brightcove add additional lifecycle events which are defined in each plugin.</p>

<p>The playback controller allows for a single delegate. In many cases, this will be enough to retrieve information; the delegate implementations can disseminate values and events to different parts of the app as necessary. In cases where multiple delegates would be required, as is the case when developing a plugin, the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L538-L655">[<code>BCOVPlaybackSessionConsumer</code>](Protocols/BCOVPlaybackSessionConsumer.html)</a> delegates provide equivalent functionality to the <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVPlaybackController.h#L667-L793">[<code>BCOVPlaybackControllerDelegate</code>](Protocols/BCOVPlaybackControllerDelegate.html)</a> methods, including <a href="https://github.com/brightcove/brightcove-player-sdk-ios/blob/fd5e766693e533854f202f270d3d62e32ceaae04/ios/dynamic/BrightcovePlayerSDK.framework/Headers/BCOVAdvertising.h#L195-L259">ad data</a>.</p>

<p>Here is an example of how one might use <a href="Protocols/BCOVPlaybackSessionConsumer.html"><code>BCOVPlaybackSessionConsumer</code></a> to create an analytics plugin:</p>

<pre><code>@interface XYZAnalytics : NSObject BCOVPlaybackSessionConsumer
@end

@implementation XYZAnalytics

- (void)playbackSession:(idBCOVPlaybackSession)session didProgressTo:(NSTimeInterval)progress
{
    //react to progress event
}

@end
</code></pre>

<p>To use the plugin:</p>

<pre><code>BCOVPlayerSDKManager *sdkManager = [BCOVPlayerSDKManager sharedManager];
id&lt;BCOVPlaybackController&gt; controller = [sdkManager createPlaybackController];
XYZAnalytics *analytics = [[XYZAnalytics alloc] init];
[controller addSessionConsumer:analytics];
</code></pre>

<h2>Handling Network Interruptions and Slowdowns <a name="HandlingNetworkInterruptionsAndSlowdowns"></a></h2>

<p>When the application experiences network interruptions, the <code>AVPlayer</code> used by the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> may stop attempting to recover if the interruption lasts too long. If this occurs, the lifecycle delegate method will be called with a <code>kBCOVPlaybackSessionLifecycleEventFailedToPlayToEndTime</code> event. When this event occurs, playback <strong>will not</strong> recover automatically. In order to recover from this event, you will need to detect when the network recovers in your client code.</p>

<p>Once you have determined that the network has recovered, you can use <code>- [</code>[BCOVPlaybackController resumeVideoAtTime:withAutoPlay:]<code>](Protocols/BCOVPlaybackController.html#//api/name/resumeVideoAtTime:withAutoPlay:)</code> to re-initialize the player. You will need to keep track of where you want to resume to. The player will make its best effort to suppress lifecycle events and progress events, in order to prevent ads from replaying or from analytics being interfered with.</p>

<p>Upon calling <code>- [</code>[BCOVPlaybackController resumeVideoAtTime:withAutoPlay:]<code>](Protocols/BCOVPlaybackController.html#//api/name/resumeVideoAtTime:withAutoPlay:)</code>, the player will send a lifecycle event of type <code>kBCOVPlaybackSessionLifecycleEventResumeBegin</code>. <code>kBCOVPlaybackSessionLifecycleEventResumeComplete</code> will be sent if this action succeeds, otherwise <code>kBCOVPlaybackSessionLifecycleEventResumeFail</code> will be sent.</p>

<p>You must wait before calling <code>- [</code>[BCOVPlaybackController resumeVideoAtTime:withAutoPlay:]<code>](Protocols/BCOVPlaybackController.html#//api/name/resumeVideoAtTime:withAutoPlay:)</code> a second time until you have received either <code>kBCOVPlaybackSessionLifecycleEventResumeComplete</code> or <code>kBCOVPlaybackSessionLifecycleEventResumeFail</code> from the previous call. You may wish to impose a retry limit, before giving the user a message that their network is too unstable.</p>

<p>When the <code>AVPlayer</code> is still able to access the network, but the video stalls because the network is too slow, the lifecycle delegate method will be called with a <code>kBCOVPlaybackSessionLifecycleEventPlaybackStalled</code> event. When playback is able to resume, the lifecycle delegate method will be called with a <code>kBCOVPlaybackSessionLifecycleEventPlaybackRecovered</code> event. These events only cover the case where normal playback stopped and does not cover buffering that occurs during a seek or initial load of the video.</p>

<p>When the video is initially loading, when a seek occurs, or when playback stalls due to a slow network, the lifecycle delegate method will be called with a <code>kBCOVPlaybackSessionLifecycleEventPlaybackBufferEmpty</code> event.  When playback is able to resume,  the lifecycle delegate method will be called with a <code>kBCOVPlaybackSessionLifecycleEventPlaybackLikelyToKeepUp</code> event.</p>

<h2>Subclassing <a name="Subclassing"></a></h2>

<p>Except where explicitly documented otherwise, none of the classes in the Player SDK for iOS are designed to be subclassed. Creating a subclass of any SDK class that is not explicitly designed to be subclassed, especially any of the value classes, could result in unpredictable behavior.</p>

<h2>Values <a name="Values"></a></h2>

<p>Also known as &ldquo;model objects&rdquo;, these classes (<a href="Classes/BCOVPlaylist.html"><code>BCOVPlaylist</code></a>, <a href="Classes/BCOVVideo.html"><code>BCOVVideo</code></a>, <a href="Classes/BCOVSource.html"><code>BCOVSource</code></a>, <a href="Classes/BCOVCuePoint.html"><code>BCOVCuePoint</code></a>, <a href="Classes/BCOVCuePointCollection.html"><code>BCOVCuePointCollection</code></a>) are used to represent data in the Player SDK for iOS. It is crucial to understand that these data types are treated as <em>values</em>, rather than <em>identities</em>. By this, we mean that if you have two instances of a value class which have the exact same data, they represent the same idea or value, even though they are technically two different objects at separate memory addresses. In other words, neither SDK code nor your client code should ever use identity comparisons (&ldquo;pointer equality&rdquo;) with value objects. Instead, each value class implements <code>-isEqual:</code> and provides a class-specific equality method overload, either of which should be used instead.</p>

<p>This is bad:</p>

<pre><code>if (myVideo == session.video) // Could lead to bugs!
</code></pre>

<p>These are good (and functionally equivalent):</p>

<pre><code>if ([myVideo isEqualToVideo:session.video])
if ([myVideo isEqual:session.video])
</code></pre>

<p>The internals of the Player SDK for iOS may do such things as memoize values or make defensive copies, so relying on the pointer address to check for equality will end up causing you pain.</p>

<p>Another quality of value classes in the Player SDK for iOS is that they are <em>immutable</em>. Once you have an instance of a value, you should not try to subvert this immutability in any way, as it may lead to unpredictable behavior. If in your code you wish to &ldquo;modify&rdquo; a value in some fashion, your only recourse is to create a new value. As a convenience to help clients obtain &ldquo;modified&rdquo; values, each of the value classes offers an <code>-update:</code> method which takes a block that allows you to operate on a mutable copy of the original value.</p>

<p>Here is an example of using this method to create a &ldquo;modified&rdquo; version of an existing video object, but with different properties:</p>

<pre><code>BCOVVideo *video1; // (properties include a key "foo" whose value is "bar")
BCOVVideo *video2 = [video1 update:^(idBCOVMutableVideo mutable) {

    mutable.properties = @{ @"foo": @"bar" };

}];

NSLog(@"foo is %@", video1.properties[@"foo"]); // prints "foo is bar"
NSLog(@"foo is %@", video2.properties[@"foo"]); // prints "foo is quux"

// Both video1 and video2 are still immutable objects:
video1.properties = otherDictionary; // causes compiler error
video2.properties = otherDictionary; // causes compiler error
</code></pre>

<p>As you can see in the example, <code>video1</code> has not been changed by the <code>-update</code> method call. Instead, this method returns a copy of <code>video1</code>, except with the modifications made in the body of the block. You should never allow the mutable copy to escape the block (such as by assigning it to a <code>__block</code> variable), instead use the immutable object returned by the <code>-update</code> method after you have made your modifications.</p>

<h2>Retrieving Brightcove Assets Using the Playback Service <a name="PlaybackService"></a></h2>

<p>The playback service class, <a href="Classes/BCOVPlaybackService.html"><code>BCOVPlaybackService</code></a>, provides functionality for retrieving your Brightcove video assets and playlists via the <a href="https://apis.support.brightcove.com/playback/getting-started/overview-playback-api.html">Brightcove Playback API</a> , including rich metadata such as text tracks, previews, and thumbnails. The following example shows how to retrieve a video with a video ID. Methods for retrieving a video or playlist with that video&rsquo;s reference ID are also available.</p>

<pre><code>[1] NSString *policyKey = &lt;your-policy-key&gt;;
    NSString *accountId = &lt;your-account-id&gt;;
    NSString *videoID = &lt;your-video-id&gt;;

    BCOVPlayerSDKManager *manager = [BCOVPlayerSDKManager sharedManager];
    id&lt;BCOVPlaybackController&gt; controller = [manager createPlaybackControllerWithViewStrategy:nil];
    [self.view addSubview:controller.view];  

    BCOVPlaybackService *playbackService = [[BCOVPlaybackService alloc] initWithAccountId:accoundId
                                                                                policyKey:policyKey];
    [playbackService findVideoWithVideoID:videoID
                               parameters:nil
                               completion:^(BCOVVideo *video,
                                            NSDictionary *jsonResponse,
                                            NSError      *error) {

                                   [controller setVideos:@[ video ]];
                                   [controller play];

                               }];
</code></pre>

<ol>
<li>The playback service requests <strong>policy key</strong> for authentication. To learn more about policy key and how to obtain one, please refer to the <a href="https://apis.support.brightcove.com/policy/getting-started/policy-keys.html">policy key documentation</a>.</li>
</ol>


<p>**NOTE: If you are using the Playback Authorization Service please review the <a href="#PlaybackAuthorizationService">section</a> of this README related to that feature.</p>

<p><strong>Playlist Paging</strong></p>

<p>For <code></code>BCOVPlaybackService` methods that return a playlist, you can request a partial playlist, or &ldquo;pages&rdquo; from the playlist by specifying a limit and offset parameter in the parameters dictionary. The limit specifies the maximum number of videos that will be returned, and the offset specifies the index into the playlist at which videos will be returned.</p>

<p>For example, if you have a playlist with 100 videos, you can request only 6 videos starting at video number 10 as follows:</p>

<pre><code>    NSDictionary *parameters =
    @{
        @"limit": @6,
        @"offset": @10
    };

    [playbackService findPlaylistWithPlaylistID:playlistID
                                     parameters: parameters
                                     completion:^(BCOVPlaylist *playlist,
                                                  NSDictionary *jsonResponse,
                                                  NSError      *error) {

        [controller setVideos: playlist];
        [controller play];

    }];
</code></pre>

<h2>View Strategy <a name="ViewStrategy"></a></h2>

<p>The <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> object is constructed with a view strategy, which allows you, as the client of the SDK, to define the exact UIView object that is returned from the playback controller&rsquo;s view property. This is important when using plugins that affect the playback controller&rsquo;s view, such as an advertising plugin that overlays the video view with an ad view.
Many apps will have no need to create a view strategy, and can simply pass <code>nil</code> when creating a new playback controller. This will create a standard video view in the playback controller.</p>

<p>The <a href="Blocks/BCOVPlaybackControllerViewStrategy.html"><code>BCOVPlaybackControllerViewStrategy</code></a> typedef aliases (and documents) this more complex block signature:</p>

<p><code>objc
UIView *(^)(UIView *videoView, idBCOVPlaybackController playbackController);
</code></p>

<p>This signature describes an Objective-C block that returns a UIView and takes two parameters: a UIView and a playback controller. The return value is the UIView object that the playback controller&rsquo;s view property will point to.
The first parameter is an UIView that contains the video layer, the UIView will show the video. The second parameter is the playback controller object to which the view strategy has been given, the playback controller can be used to add necessary session consumers such as video controls or ad controls.</p>

<p>Example of view strategy implementation:</p>

<p>```objc
BCOVPlaybackControllerViewStrategy viewStrategy = ^(UIView *videoView, id<BCOVPlaybackController> playbackController) {</p>

<pre><code>// Create some custom controls for the video view,
// and compose both into a container view.
[1] UIView&lt;BCOVPlaybackSessionConsumer&gt; *myControlsView = [[MyControlsView alloc] init];
[2] UIView *controlsAndVideoView = [[UIView alloc] init];
[3] [controlsAndVideoView addSubview:videoView];
    [controlsAndVideoView addSubview:myControlsView];
// Compose the container with an advertising view
// into another container view.
[4] UIView&lt;BCOVPlaybackSessionConsumer&gt; *adView = [[SomeAdPluginView alloc] init];
[5] UIView *adAndVideoView = [[UIView alloc] init];
[6] [adAndVideoView addSubview:controlsAndVideoView];
    [adAndVideoView addSubview:adView];
[7] [playbackController addSessionConsumer:myControlsView];
    [playbackController addSessionConsumer:adView];
// This container view will become `playbackController.view`.
return adAndVideoView;
</code></pre>

<p>};
<code>``
Breaking the code down into steps:
[1] Create a custom controls view that conforms to the </code>BCOVPlaybackSessionConsumer<code> protocol. </code>BCOVPlaybackSessionConsumer<code>protocol allows to receive basic playback information for each video in addition to advertising.
[2] Create a container view for the video view and custom controls.
[3] Add as a subview the video container and the custom controls. The hierarchy is composed in the same order that views are added.
[4] Create an ad controls view that conforms to the </code>BCOVPlaybackSessionConsumer` protocol.
[5] Create a container view for the video view and controls, and the advertising view.
[6] Add as a subview the video container and the ad controls view.
[7] Register the custom controls view and the ad controls view as session consumers using the playback controller object returned by the block.</p>

<p>There is one caveat to using a view strategy: you must not access the playback controller&rsquo;s <code>view</code> property from within the view strategy block. Since the block is being called <em>because</em> the playback controller&rsquo;s <code>view</code> property was accessed for the first time, accessing the <code>view</code> property again <em>within</em> the view strategy block will cause your program to crash.</p>

<h2>Playing Video In The Background <a name="BackgroundVideo"></a></h2>

<p>By default, when an iOS application is sent to the background, or the device is locked, iOS will pause any video that is playing. To change this behavior, set the <code>allowsBackgroundAudioPlayback</code> property of the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> object to <code>YES</code>. (The default value is <code>NO</code>, indicating playback will pause in the background.)</p>

<p>You should also follow the guidelines set by Apple in <a href="https://developer.apple.com/library/ios/qa/qa1668">Technical Q&amp;A QA1668</a> to set the proper background modes and audio session category for your app.</p>

<p>It&rsquo;s important that the <code>AVPlayerLayer</code> be detached from the <code>AVPlayer</code> before the app is switched to the background (and reattached when the app returns to the foreground). The Brightcove Player SDK will handle this for you when <code>allowsBackgroundAudioPlayback</code> is set to <code>YES</code>.</p>

<p>Finally, when playing background videos (and particularly when using playlists), you should use the iOS <code>MPRemoteCommandCenter</code> API to give the user playback control on the lock screen and in the control center.</p>

<h2>Picture in Picture <a name="PIP"></a></h2>

<p>To enable Picture-in-Picture in your application, set the <code>showPictureInPictureButton</code> property of the <a href="Classes/BCOVPUIPlayerViewOptions.html"><code>BCOVPUIPlayerViewOptions</code></a> object to <code>YES</code> when instantiating your <a href="Classes/BCOVPUIPlayerView.html"><code>BCOVPUIPlayerView</code></a> object. The Picture-in-Picture button will then be displayed in the controls bar on any device that support it.</p>

<p>For Picture-in-Picture to work properly you will need to ensure that the <code>Audio, AirPlay, and Picture in Picture</code> mode is turned in the <code>Background Modes</code> section of the target Capabilities tab of your project. You should also follow the guidelines set by Apple in <a href="https://developer.apple.com/library/ios/qa/qa1668">Technical Q&amp;A QA1668</a> to set the proper background modes and audio session category for your app.</p>

<p>The <code>AVPictureInPictureControllerDelegate</code> methods are passed along via <a href="Protocols/BCOVPUIPlayerViewDelegate.html"><code>BCOVPUIPlayerViewDelegate</code></a>. These methods are:</p>

<pre><code>- (void)pictureInPictureControllerDidStartPictureInPicture:(AVPictureInPictureController *)pictureInPictureController;
- (void)pictureInPictureControllerDidStopPictureInPicture:(AVPictureInPictureController *)pictureInPictureController;
- (void)pictureInPictureControllerWillStartPictureInPicture:(AVPictureInPictureController *)pictureInPictureController;
- (void)pictureInPictureControllerWillStopPictureInPicture:(AVPictureInPictureController *)pictureInPictureController;
- (void)pictureInPictureController:(AVPictureInPictureController *)pictureInPictureController failedToStartPictureInPictureWithError:(NSError *)error
- (void)pictureInPictureController:(AVPictureInPictureController *)pictureInPictureController restoreUserInterfaceForPictureInPictureStopWithCompletionHandler:(void (^)(BOOL))completionHandler;
</code></pre>

<p>See Apple&rsquo;s <a href="https://developer.apple.com/documentation/avkit/avpictureinpicturecontrollerdelegate">AVPictureInPictureControllerDelegate</a> documentation for more information.</p>

<p>To implement your own Picture-in-Picture behavior, keep the <code>pictureInPictureActive</code> property of <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> updated with the Picture-in-Picture status. If you are using the <code>AVPictureInPictureController</code>, you can use the <code>pictureInPictureControllerDidStartPictureInPicture:</code> and <code>pictureInPictureControllerDidStopPictureInPicture:</code> delegate methods to update this property.</p>

<p>You can read more about implmeneting Picture-in-Picture in Apple&rsquo;s <a href="https://developer.apple.com/documentation/avkit/adopting_picture_in_picture_in_a_custom_player">Adopting Picture in Picture in a Custom Player</a> documentation.</p>

<p>Using a playlist of videos with mixed formats with picture-in-picture will result in the picture-in-picture window closing between each video.</p>

<p>iOS and iPadOS 14 introduced automatic Picture-in-Picture behavior which can be toggled on/off in <code>Settings &gt; General &gt; Picture in Picture</code>. In order for this feature to work as expected the player view must be equal to the width of the screen and the height must have a ratio of at least 0.57 to the width (16:9 or larger). If the width or height of your player view are smaller than these values Picture-in-Picture may not automatically be triggered when the application enters the background.</p>

<p><strong>Important: The Brightcove Native Player SDK&rsquo;s Picture-in-Picture functionality does not support videos with ad playback. Trying to use a video with ads with the Picture-in-Picture functionality active will result in unexpected behavior.</strong></p>

<h2>Thumbnail Seeking <a name="ThumbnailSeeking"></a></h2>

<p>Thumbnail seeking allows users to drag the playhead along the timeline and view thumbnails as a preview of the associated content. This gives users the ability to quickly navigate a video file and find the content that they are interested in.</p>

<p>This feature is also referred to by Apple as Trick Play, and is referenced in their <a href="https://developer.apple.com/documentation/http_live_streaming/hls_authoring_specification_for_apple_devices?language=objc">HLS Authoring Specification</a>.</p>

<p>This feature is enabled by default. If you wish to disable thumbnail seeking you can do so by setting the <code>thumbnailSeekingEnabled</code> property on your <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> to <code>NO</code>.</p>

<pre><code>self.playbackController.thumbnailSeekingEnabled = NO;
</code></pre>

<p>You can customize the layout of the thumbnail preview by making use of a delegate method with your <a href="Classes/BCOVPUIPlayerView.html"><code>BCOVPUIPlayerView</code></a> or <a href="Classes/BCOVTVPlayerView.html"><code>BCOVTVPlayerView</code></a>.</p>

<p>On iOS you can adjust the height, width and vertical offset:</p>

<pre><code>- (void)setupPlayerView
{
    BCOVPUIPlayerView *playerView = [[BCOVPUIPlayerView alloc] initWithPlaybackController:nil];
    playerView.delegate = self;
    ...
}

#pragma mark - BCOVPUIPlayerViewDelegate

- (CGRect)playerViewShouldDisplayThumbnailPreviewWithRect:(BCOVPUIPlayerView *)playerView
{
    CGFloat width = 100;
    CGFloat height = 56;
    CGFloat verticalOffset = -60;
    CGFloat modifier = 1;
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
    {
        modifier = 2;
    }
    return CGRectMake(0, verticalOffset * modifier, width * modifier, height * modifier);
}
</code></pre>

<p>On tvOS you can adjust the height and width:</p>

<pre><code>- (void)setupPlayerView
{
    self.playerView = [[BCOVTVPlayerView alloc] initWithOptions:nil];    
    self.playerView.delegate = self;
    ...
}

#pragma mark - BCOVTVPlayerViewDelegate

- (CGSize)playerViewShouldDisplayThumbnailPreviewWithSize:(BCOVTVPlayerView *)playerView
{
    CGSize size = self.view.frame.size;
    size.width = size.width / 6;
    size.height = size.height / 6;
    return size;
}
</code></pre>

<p>If manually constructing a <a href="Classes/BCOVVideo.html"><code>BCOVVideo</code></a> object you can set the URL to be used for the I-FRAME source:</p>

<pre><code>BCOVVideo *video = [BCOVVideo videoWithURL:[NSURL URLWithString:@"https://mydomain.com/master.m3u8"]];
video = [video update:^(id&lt;BCOVMutableVideo&gt; mutableVideo) {
    mutableVideo.iFramePlaylistURL = [NSURL URLWithString:@"https://mydomain.com/iframe.m3u8"];
}];
</code></pre>

<p>Thumbnail scrubbing is only available for online videos; downloaded/offline videos do not support this feature.</p>

<h2>Tracking Errors <a name="TrackingErrors"></a></h2>

<p>Playback errors are typically handled and reported through video playback events from the playback controller. If you need to dig deeper and track problems with particular videos or app sessions, you can take advantage of the Brightcove Player SDK&rsquo;s <em>session ID</em>. The session ID is a property of the <a href="Classes/BCOVPlayerSDKManager.html"><code>BCOVPlayerSDKManager</code></a> that you can retrieve like this:</p>

<pre><code>NSString *sdkSessionID = BCOVPlayerSDKManager.sharedManager.sessionID;
</code></pre>

<p>The session ID is a unique string that does not change during the app life cycle. This string is reported with various other analytics data to the Brightcove metrics servers. If you are having problems with a particular app instance, or video, you can record the session ID and send it back to your own company servers. Then you can send the session ID, video ID, and any other pertinent data to Brightcove service engineers to help diagnose any issues.</p>

<h2>Combining Plugins <a name="CombiningPlugins"></a></h2>

<p>If you need to combine Player SDK plugins, for example to add subtitles to a DRM-protected video which plays ads managed by Google IMA, <code>BCOVSessionProviders</code> from each plugin are created and chained together and the chain is used to construct the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a>.</p>

<pre><code>BCOVPlayerSDKManager *sdkManager = [BCOVPlayerSDKManager sharedManager];

IMASettings *imaSettings = [[IMASettings alloc] init];
imaSettings.ppid = kViewControllerIMAPublisherID;
imaSettings.language = kViewControllerIMALanguage;
imaSettings.enableBackgroundPlayback = self.allowBackgroundAudioPlayback;

IMAAdsRenderingSettings *renderSettings = [[IMAAdsRenderingSettings alloc] init];
renderSettings.webOpenerPresentingController = self;

BCOVIMAAdsRequestPolicy *adsRequestPolicy =
    [BCOVIMAAdsRequestPolicy videoPropertiesVMAPAdTagUrlAdsRequestPolicy];


// create the sidecar subtitles session provider. it has no upstream session provider.
id&lt;BCOVPlaybackSessionProvider&gt; *sidecarSessionProvider =
    [sdkManager createSidecarSubtitlesSessionProviderWithUpstreamSessionProvider:nil];

// create the IMA session provider with an upstream sidecar subtitles session provider.
id&lt;BCOVPlaybackSessionProvider&gt; *imaSessionProvider =
    [sdkManager createIMASessionProviderWithSettings:imaSettings
                                adsRenderingSettings:renderSettings
                                    adsRequestPolicy:adsRequestPolicy
                                         adContainer:self.playerView.contentOverlayView
                                      companionSlots:nil
                             upstreamSessionProvider:sidecarSessionProvider];

// create the playback controller using the session provider chain.
id&lt;BCOVPlaybackController&gt; *playbackController =
    [sdkManager createPlaybackControllerWithSessionProvider:imaSessionProvider
                                               viewStrategy:nil];
</code></pre>

<h1>Buffer Optimization <a name="BufferOptimization"></a></h1>

<h2>Overview</h2>

<p>Developers have control over the size of the forward playback buffer used by the <code>AVPlayer</code>. This is done by setting the <code>preferredForwardBufferDuration</code> property in the <code>AVPlayerItem</code> class.</p>

<p>By default, the Brightcove Native Player SDK sets the <code>preferredForwardBufferDuration</code> property in a way that optimizes overall bandwidth without sacrificing playback quality. This behavior can be overridden with your own values.</p>

<h2>Default Behavior</h2>

<p>Everyone pays for bandwidth, so it&rsquo;s important to reduce bandwidth consumption without affecting playback quality. New with version 5.2.0, the Brightcove Native Player SDK manages the buffer size for you dynamically as the video plays.</p>

<p>Prior to iOS 10, the <code>AVPlayer</code> buffered as much video data as it practicably could, up to around 50 Megabytes. This is fine for the video viewing model where a user selects a video and then watches it until the end, but many modern apps now &ldquo;tease&rdquo; videos with autoplay, hoping to secure engagement after a few seconds. A lot of users simply move on to different videos. With aggressive buffering you can end up with several minutes of buffered video that are thrown away with each video impression.</p>

<p>The Brightcove Native Player SDK addresses this problem by starting the video with a small baseline buffer, and then increasing it as the user watches more of the video. After a certain point, the buffer size is capped since it is not practical or helpful to make it too large.</p>

<h2>Modifying The Default Behavior</h2>

<p>If you want to keep the default behavior of the Brightcove Native Player SDK, but modify the minimum and maximum values used for the buffer sizes, you can do the following when setting up the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a>:</p>

<pre><code>// Create mutable dictionary to hold new values
NSMutableDictionary *options = self.playbackController.options.mutableCopy;

// Set new values in dictionary
options[kBCOVBufferOptimizerMethodKey] = @(BCOVBufferOptimizerMethodDefault);
options[kBCOVBufferOptimizerMinimumDurationKey] = @(min);
options[kBCOVBufferOptimizerMaximumDurationKey] = @(max);

// Set new dictionary in your playback controller
self.playbackController.options = options;
</code></pre>

<p>These options should be set before calling <code>-BCOVPlaybackController setVideos:</code>.</p>

<p><code>min</code> and <code>max</code> values:</p>

<ul>
<li>These are floating point values that you can set as the new minimum and maximum buffer durations.</li>
<li>If the values are set too small, playback may stall under erratic network conditions.</li>
<li>If the values are set too large, the <code>AVPlayer</code> may buffer data that is never viewed.</li>
<li>Testing based on your expected use cases is important.</li>
<li>Values are specified in seconds of time, and must be greater than or equal to 1.0. (Zero is a special value in the <code>AVPlayerItem</code> that tells the <code>AVPlayer</code> to determine its own buffer size.</li>
</ul>


<h2>Turning Off Buffer Optimization</h2>

<p>If you do not want any buffer optimization active in your current playback session, you can use the same technique, but set the optimziation method to &ldquo;None&rdquo; as follows:</p>

<pre><code>// Create mutable dictionary to hold new values
NSMutableDictionary *options = self.playbackController.options.mutableCopy;

// Set new values in dictionary
options[kBCOVBufferOptimizerMethodKey] = @(BCOVBufferOptimizerMethodNone);

// Set new dictionary in your playback controller
self.playbackController.options = options;
</code></pre>

<p>With the method set to “None”, iOS will maintain full control of the forward buffer size.</p>

<h2>Implementing Your Own Buffer Optimization Method</h2>

<p>If you want to set your own buffer size for playback, first turn off buffer optimization as described in the previous section. Then, you can implement the following <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a> delegate method:</p>

<pre><code>- (void)playbackController:(id&lt;BCOVPlaybackController&gt;)controller didAdvanceToPlaybackSession:(id&lt;BCOVPlaybackSession&gt;)session
{
  // Make sure the property exists on the current AVPlayerItem.
  if ([session.player.currentItem respondsToSelector:NSSelectorFromString(@"preferredForwardBufferDuration")])
  {
    // Set your preferredForwardBufferDuration value here.
     session.player.currentItem.preferredForwardBufferDuration = newPreferredForwardBufferDurationValue;
  }
}
</code></pre>

<p>If you want to change the buffer size dynamically over time, you can set <code>session.player.currentItem.preferredForwardBufferDuration</code> in the <a href="Protocols/BCOVPlaybackController.html"><code>BCOVPlaybackController</code></a>&rsquo;s progress delegate method in a similar fashion:</p>

<pre><code>- (void)playbackController:(id&lt;BCOVPlaybackController&gt;)controller playbackSession:(id&lt;BCOVPlaybackSession&gt;)session didProgressTo:(NSTimeInterval)progress
{
  // Make sure the property exists on the current AVPlayerItem.
  if ([session.player.currentItem respondsToSelector:NSSelectorFromString(@"preferredForwardBufferDuration")])
  {
    // Set preferredForwardBufferDuration based on your own logic here
     session.player.currentItem.preferredForwardBufferDuration = newPreferredForwardBufferDurationValue;
  }
}
</code></pre>

<p>Note: Apple specifically put &ldquo;preferred&rdquo; in <code>preferredForwardBufferDuration</code> because you can set any value you want, but generally speaking the <code>AVPlayer</code> player will use it only as a guideline. Also keep in mind that setting it to zero returns full control of the buffer size to the <code>AVPlayer</code>.</p>

<h1>Using an AVPlayerViewController with a <a href="Protocols/BCOVPlaybackController.html">BCOVPlaybackController</a> <a name="AVPlayerViewController"></a></h1>

<h2>Overview</h2>

<p>You can use the AVPlayerViewController instead of the AVPlayerLayer used by the <a href="Protocols/BCOVPlaybackSession.html">BCOVPlaybackSession</a> class. Using the AVPlayerViewController allows the player to use the native iOS and tvOS player controls, but there are limitations to this approach (see below).</p>

<p>To use the AVPlayerViewController, you can set a <a href="Protocols/BCOVPlaybackController.html">BCOVPlaybackController</a> dictionary property called <code>kBCOVAVPlayerViewControllerCompatibilityKey</code>:</p>

<pre><code>BCOVPlayerSDKManager *sdkManager = [BCOVPlayerSDKManager sharedManager];

idBCOVPlaybackController playbackController;

NSMutableDictionary *mutableOptions = self.playbackController.options.mutableCopy;
// To use the AVPlayerViewController
mutableOptions[kBCOVAVPlayerViewControllerCompatibilityKey] = @YES;

// To use the BCOVPlaybackSession's AVPlayerLayer
// mutableOptions[kBCOVAVPlayerViewControllerCompatibilityKey] = @NO;

self.playbackController.options = mutableOptions;
</code></pre>

<p>The default value of kBCOVAVPlayerViewControllerCompatibilityKey is @NO, which means that a <a href="Protocols/BCOVPlaybackController.html">BCOVPlaybackController</a> created without this dictionary property explicitly set will use the BCOVPlaybackSession&rsquo;s AVPlayerLayer by default.</p>

<h2>Sample Projects</h2>

<p>We have sample projects demonstrating the use of AVPlayerViewController with the Brightcove iOS SDK.  You can find the <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/NativeControls">iOS sample project here</a> and the <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/IMA/NativeControlsIMAPlayer_tvOS">tvOS sample project here</a>.</p>

<h2>Limitations to Using the AVPlayerViewController</h2>

<p><strong>Advertising:</strong></p>

<p>The Brightcove IMA and FreeWheel ad plugins are compatible when using AVPlayerViewController. You can use the AVPlayerViewController&rsquo;s <code>contentOverlayView</code> for the view in which to display ads.</p>

<p>You may wish to hide/show the AVPlayerViewController&rsquo;s playback controls before and after ads play:</p>

<pre><code>- (void)playbackController:(id&lt;BCOVPlaybackController&gt;)controller playbackSession:(id&lt;BCOVPlaybackSession&gt;)session didEnterAdSequence:(BCOVAdSequence *)adSequence
{
    self.avpvc.showsPlaybackControls = NO;
}

- (void)playbackController:(id&lt;BCOVPlaybackController&gt;)controller playbackSession:(id&lt;BCOVPlaybackSession&gt;)session didExitAdSequence:(BCOVAdSequence *)adSequence
{
    self.avpvc.showsPlaybackControls = YES;
}
</code></pre>

<p>The Brightcove SSAI and Pulse ad plugins are not currently compatible with AVPlayerViewController.</p>

<p><strong>Analytics:</strong></p>

<p>When using the AVPlayerViewController, the video_engagement events sent to the Brightcove Analytics server will report 0 for player_width and player_height.</p>

<h1>Playback Authorization Service <a name="PlaybackAuthorizationService"></a></h1>

<p>If you are using the Playback Authorization Service you will need to use the playback service methods that allow you to pass in an authorization token.</p>

<pre><code>- (void)findPlaylistWithPlaylistID:(NSString *)playlistID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;

- (void)findPlaylistWithReferenceID:(NSString *)referenceID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVPlaylist *playlist, NSDictionary *jsonResponse, NSError *error))completionHandler;

- (void)findVideoWithVideoID:(NSString *)videoID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;

- (void)findVideoWithReferenceID:(NSString *)referenceID authToken:(NSString *)authToken parameters:(NSDictionary *)parameters completion:(void (^)(BCOVVideo *video, NSDictionary *jsonResponse, NSError *error))completionHandler;
</code></pre>

<p><strong>Note: In the case of playlists, all videos in the playlist must use the same token.  In a subsequent release, assigning a different token to each video in a playlist will be possible.  You will be responsible for maintaining the mapping between video id and token.</strong></p>

<h1>VoiceOver Support <a name="VoiceOver"></a></h1>

<p>VoiceOver is supported out-of-the-box for the playback controls. By default, if VoiceOver is enabled, the BCOVPlayerUI control view will not auto-hide. Using the double-tap VoiceOver activation gesture on the playback controller&rsquo;s view will toggle the visibility of the control view. There is an associated <code>accessibilityHint</code> that is set on the playback controller&rsquo;s view. The <code>accessibilityLabel</code> of each BCOVPlayerUI control can be customized within your application.</p>

<p>To change the <code>accessibilityLabel</code> values of any of the buttons in the control view you must set an object to be a <a href="Protocols/BCOVPUIButtonAccessibilityDelegate.html"><code>BCOVPUIButtonAccessibilityDelegate</code></a> like this:</p>

<pre><code>[self.playerView.controlsView setButtonsAccessibilityDelegate:self];
</code></pre>

<p>You must then have that object conform to the <a href="Protocols/BCOVPUIButtonAccessibilityDelegate.html"><code>BCOVPUIButtonAccessibilityDelegate</code></a> protocol by implmenting the <code>- (NSString *)accessibilityLabelForButton:(</code>BCOVPUIButton<code> *)button isPrimaryState:(BOOL)isPrimaryState</code> method similar to this:</p>

<pre><code>- (NSString *)accessibilityLabelForButton:(BCOVPUIButton *)button isPrimaryState:(BOOL)isPrimaryState
{
    switch (button.tag)
    {
        case BCOVPUIViewTagButtonPlayback:
            return isPrimaryState ? NSLocalizedString(@"Start Playback", nil) : NSLocalizedString(@"Stop PLayback", nil);
        case BCOVPUIViewTagButtonScreenMode:
            return isPrimaryState ? NSLocalizedString(@"Enter Fullscreen", nil) : NSLocalizedString(@"Exit Fullscreen", nil);
        case BCOVPUIViewTagButtonJumpBack:
            return nil;
        case BCOVPUIViewTagButtonClosedCaption:
            return nil;
        case BCOVPUIViewTagButtonVideo360:
            return nil;
        case BCOVPUIViewTagButtonPreferredBitrate:
            return nil;
        default:
            return nil;
    }
}
</code></pre>

<p>If a <code>nil</code> value is returned the default value will be used.</p>

<p>Setting the <code>accessibilityHint</code> on the playback controller can be done like this:</p>

<pre><code>self.playbackController.view.accessibilityHint = @"Double tap to show or hide controls";
</code></pre>

<p>Similarly you can set the <code>accessibilityLabel</code> on the current time and duration labels, along with the progress slider, like this:</p>

<pre><code>self.playerView.controlsView.durationLabel.accessibilityLabelPrefix = @"Total Time";
self.playerView.controlsView.currentTimeLabel.accessibilityLabelPrefix = @"Current Time";
self.playerView.controlsView.progressSlider.accessibilityLabel = @"Timeline";
</code></pre>

<h1>China Delivery <a name="ChinaDelivery"></a></h1>

<p>To define a proxy domain for playback services, metrics and analytics servers in China, set the <code>chinaProxyDomain</code> property of the <a href="Classes/BCOVGlobalConfiguration.html"><code>BCOVGlobalConfiguration</code></a> singleton to a fully qualified domain name. For example:</p>

<pre><code>BCOVGlobalConfiguration.sharedConfig.chinaProxyDomain = @"host.mydomain.com";
</code></pre>

<p>Be sure to set the proxy domain name before using any other services of the Native Player SDK. Refer to the <a href="https://docs.brightcove.com/ios-sdk/Classes/BCOVGlobalConfiguration.html#//api/name/chinaProxyDomain"><em>BCOVGlobalConfiguration Class Reference</em></a> for details.</p>

<h1>AVAudioSession Configuration <a name="AVAudioSessionConfig"></a></h1>

<p>Depending on how you need your application to perform when it comes to audio playback you can configure AVAudioSession to suit your specific needs. For example if you want to support AirPlay 2 and multiple audio routes see the <a href="#AirPlay">AirPlay</a> section of this README.</p>

<p>A basic AVAudioSession can be configured like this:</p>

<pre><code>//  Obj-C
NSError *categoryError = nil;
// see https://developer.apple.com/documentation/avfoundation/avaudiosessioncategoryplayback
BOOL success = [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:&amp;categoryError];

if (!success)
{
    // Handle error
}
</code></pre>

<pre><code>// Swift
var categoryError :NSError?
var success: Bool
do {
    // see https://developer.apple.com/documentation/avfoundation/avaudiosessioncategoryplayback
    try AVAudioSession.sharedInstance().setCategory(.playback)
    success = true
} catch let error as NSError {
    categoryError = error
    success = false
}

if !success {
    // Handle error
}
</code></pre>

<p>This configuration can typically be done in your AppDelegate&rsquo;s <code>application:didFinishLaunchingWithOptions:</code> method. There may be situations where you need a more sophisticated AVAudioSession configuration, for example if you want to allow audio from other apps to be heard when the audio in your app is muted. In this situation you can configure the AVAudioSession in the view controller that has access to your current AVPlayer. For example:</p>

<pre><code>// Swift
func setUpAudioSession() {
    var categoryError :NSError?
    var success: Bool

    do {
        if let currentPlayer = currentPlayer {
            // If the player is muted, then allow mixing.
            // Ensure other apps can have their background audio
            // active when this app is in foreground
            if currentPlayer.isMuted {
                try AVAudioSession.sharedInstance().setCategory(.playback, options: .mixWithOthers)
            } else {
                try AVAudioSession.sharedInstance().setCategory(.playback, options: AVAudioSession.CategoryOptions(rawValue: 0))
            }
        } else {
            try AVAudioSession.sharedInstance().setCategory(.playback, options: AVAudioSession.CategoryOptions(rawValue: 0))
        }

        success = true
    } catch let error as NSError {
        categoryError = error
        success = false
    }

    if !success {
        print("AppDelegate Debug - Error setting AVAudioSession category.  Because of this, there may be no sound. \(categoryError!)")
    }
}
</code></pre>

<pre><code>// Objc-C
- (void)setUpAudioSession
{
    NSError *categoryError = nil;
    BOOL success;

    // If the player is muted, then allow mixing.
    // Ensure other apps can have their background audio
    // active when this app is in foreground
    if (self.currentPlayer.isMuted)
    {
        success = [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback withOptions:AVAudioSessionCategoryOptionMixWithOthers error:&amp;categoryError];
    }
    else
    {
        success = [[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback withOptions:0 error:&amp;categoryError];
    }

    if (!success)
    {
        NSLog(@"AppDelegate Debug - Error setting AVAudioSession category.  Because of this, there may be no sound. `%@`", categoryError);
    }
}
</code></pre>

<p>Sample code can be found in our <a href="https://github.com/BrightcoveOS/ios-player-samples/tree/master/Player/VideoCloudBasicPlayer">VideoCloudBasicPlayer</a> sample project.</p>

<p>You can read more about AVAudioSession <a href="https://developer.apple.com/documentation/avfoundation/avaudiosession">here</a>.</p>

<h1>Frequently Asked Questions <a name="FAQ"></a></h1>

<p><strong>My content won&rsquo;t load. Is there an easy way to test whether the URL points to a valid video?</strong></p>

<p>If the content is packaged as MP4, you can paste the URL directly into most web browsers, and the video should play (or download to your filesystem, where you can play it locally). If the content is packaged as HLS, you can use QuickTime Player to test it: select <code>File -&gt; Open Location…</code> and paste in the <code>.m3u8</code> playlist URL, and the video should play.</p>

<p><strong>I can hear the audio track playing, but the video freezes for a few seconds sporadically. What&rsquo;s happening?</strong></p>

<p>This is a common symptom of having called a main thread-only UIKit or AVFoundation method from a non-main thread. The delegate methods on <a href="Protocols/BCOVPlaybackControllerDelegate.html"><code>BCOVPlaybackControllerDelegate</code></a> are always called on the main thread.</p>

<p><strong>Why do I see a message in the log indicating that no source has been found?</strong></p>

<p>This message indicates that the default source selection policy can&rsquo;t figure which source to pick. The default policy selects the first source whose <code>deliveryMethod</code> is <code>kBCOVSourceDeliveryHLS</code> (&ldquo;HLS&rdquo;). If no HLS source is found, its fallback behavior will select the first source whose <code>deliveryMethod</code> is <code>kBCOVSourceDeliveryMP4</code> (&ldquo;MP4&rdquo;). If no source with a <code>deliveryMethod</code> of &ldquo;HLS&rdquo; or &ldquo;MP4&rdquo; exists on the video, the policy will select the video&rsquo;s first source (regardless of <code>deliveryMethod</code>). If you aren&rsquo;t happy with its selection, you can use <a href="Classes/BCOVPlayerSDKManager.html#//api/name/createBasicSessionProviderWithOptions:"><code>[BCOVPlayerSDKManager createBasicSessionProviderWithOptions:]</code></a> and pass in an instance of <a href="Classes/BCOVBasicSessionProviderOptions.html"><code>BCOVBasicSessionProviderOptions</code></a> with a custom <code>sourceSelectionPolicy</code> property set. When creating videos and sources manually, ensure that the sources are created with the appropriate <code>deliveryMethod</code>.</p>

<p><strong><a href="https://developer.apple.com/Library/ios/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/AudioGuidelinesByAppType/AudioGuidelinesByAppType.html">Apple recommends</a> that apps which play video should still play audio even when the device is muted. Why doesn&rsquo;t the Brightcove Player SDK for iOS respect these guidelines?</strong></p>

<p>The API which controls whether an app emits audio in iOS apps is the <a href="https://developer.apple.com/Library/ios/documentation/Audio/Conceptual/AudioSessionProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007875-CH1-SW1">AVAudioSession API</a>. An audio session is global to an app, which means that its configuration affects both the sounds that are emitted by the AVPlayers created by the Player SDK, as well as other sounds that an app may produce. Since the Player SDK cannot know how the app wants the audio session configured for those other sounds, it doesn&rsquo;t affect the audio session at all. This means that unless you explicitly configure your app&rsquo;s audio session otherwise, you inherit the default behavior of suppressing any and all audio when the device is muted, including audio emitted by AVPlayers. To conform to Apple&rsquo;s recommendations regarding audio playback, you (the app developer) must configure the audio session according to your app&rsquo;s specific needs.</p>

<p>See our <a href="#AVAudioSessionConfig">AVAudioSession Configuration</a> section in this README for additional information.</p>

<h1>Support <a name="Support"></a></h1>

<p>If you have questions, need help or want to provide feedback, please use the <a href="https://supportportal.brightcove.com/s/login/">Support Portal</a> or contact your Account Manager.  To receive notification of new SDK software releases, subscribe to the Brightcove Native Player SDKs <a href="https://groups.google.com/g/brightcove-native-player-sdks">Google Group</a>.</p>
						
						
					</div>
					

					<div class="index-container">
						

						
						<div class="index-column">
							<h2 class="index-title">Class References</h2>
							<ul>
								
								<li><a href="Classes/BCOVAd.html">BCOVAd</a></li>
								
								<li><a href="Classes/BCOVAdSequence.html">BCOVAdSequence</a></li>
								
								<li><a href="Classes/BCOVBasicSessionProvider.html">BCOVBasicSessionProvider</a></li>
								
								<li><a href="Classes/BCOVBasicSessionProviderOptions.html">BCOVBasicSessionProviderOptions</a></li>
								
								<li><a href="Classes/BCOVBasicSourceSelectionPolicy.html">BCOVBasicSourceSelectionPolicy</a></li>
								
								<li><a href="Classes/BCOVCuePoint.html">BCOVCuePoint</a></li>
								
								<li><a href="Classes/BCOVCuePointCollection.html">BCOVCuePointCollection</a></li>
								
								<li><a href="Classes/BCOVCuePointProgressPolicy.html">BCOVCuePointProgressPolicy</a></li>
								
								<li><a href="Classes/BCOVCuePointProgressPolicyResult.html">BCOVCuePointProgressPolicyResult</a></li>
								
								<li><a href="Classes/BCOVFPSBrightcoveAuthProxy.html">BCOVFPSBrightcoveAuthProxy</a></li>
								
								<li><a href="Classes/BCOVFairPlayManager.html">BCOVFairPlayManager</a></li>
								
								<li><a href="Classes/BCOVGlobalConfiguration.html">BCOVGlobalConfiguration</a></li>
								
								<li><a href="Classes/BCOVOfflineVideoManager.html">BCOVOfflineVideoManager</a></li>
								
								<li><a href="Classes/BCOVOfflineVideoStatus.html">BCOVOfflineVideoStatus</a></li>
								
								<li><a href="Classes/BCOVPUIAdControlView.html">BCOVPUIAdControlView</a></li>
								
								<li><a href="Classes/BCOVPUIBasicControlView.html">BCOVPUIBasicControlView</a></li>
								
								<li><a href="Classes/BCOVPUIButton.html">BCOVPUIButton</a></li>
								
								<li><a href="Classes/BCOVPUICommon.html">BCOVPUICommon</a></li>
								
								<li><a href="Classes/BCOVPUIControlLayout.html">BCOVPUIControlLayout</a></li>
								
								<li><a href="Classes/BCOVPUILayoutView.html">BCOVPUILayoutView</a></li>
								
								<li><a href="Classes/BCOVPUIPlayerView.html">BCOVPUIPlayerView</a></li>
								
								<li><a href="Classes/BCOVPUIPlayerViewOptions.html">BCOVPUIPlayerViewOptions</a></li>
								
								<li><a href="Classes/BCOVPUISlider.html">BCOVPUISlider</a></li>
								
								<li><a href="Classes/BCOVPlaybackService.html">BCOVPlaybackService</a></li>
								
								<li><a href="Classes/BCOVPlaybackServiceRequestFactory.html">BCOVPlaybackServiceRequestFactory</a></li>
								
								<li><a href="Classes/BCOVPlaybackSessionLifecycleEvent.html">BCOVPlaybackSessionLifecycleEvent</a></li>
								
								<li><a href="Classes/BCOVPlayerSDKManager.html">BCOVPlayerSDKManager</a></li>
								
								<li><a href="Classes/BCOVPlaylist.html">BCOVPlaylist</a></li>
								
								<li><a href="Classes/BCOVPreferredBitrateConfig.html">BCOVPreferredBitrateConfig</a></li>
								
								<li><a href="Classes/BCOVSessionProviderExtension.html">BCOVSessionProviderExtension</a></li>
								
								<li><a href="Classes/BCOVSource.html">BCOVSource</a></li>
								
								<li><a href="Classes/BCOVTVAudioTabBarItemView.html">BCOVTVAudioTabBarItemView</a></li>
								
								<li><a href="Classes/BCOVTVCommon.html">BCOVTVCommon</a></li>
								
								<li><a href="Classes/BCOVTVControlsView.html">BCOVTVControlsView</a></li>
								
								<li><a href="Classes/BCOVTVInfoTabBarItemView.html">BCOVTVInfoTabBarItemView</a></li>
								
								<li><a href="Classes/BCOVTVPlayerView.html">BCOVTVPlayerView</a></li>
								
								<li><a href="Classes/BCOVTVPlayerViewOptions.html">BCOVTVPlayerViewOptions</a></li>
								
								<li><a href="Classes/BCOVTVProgressView.html">BCOVTVProgressView</a></li>
								
								<li><a href="Classes/BCOVTVSettingsView.html">BCOVTVSettingsView</a></li>
								
								<li><a href="Classes/BCOVTVSubtitlesTabBarItemView.html">BCOVTVSubtitlesTabBarItemView</a></li>
								
								<li><a href="Classes/BCOVTVTabBarItemView.html">BCOVTVTabBarItemView</a></li>
								
								<li><a href="Classes/BCOVUILabel.html">BCOVUILabel</a></li>
								
								<li><a href="Classes/BCOVVideo.html">BCOVVideo</a></li>
								
								<li><a href="Classes/BCOVVideo360ViewProjection.html">BCOVVideo360ViewProjection</a></li>
								
							</ul>
						</div>
						

						
						<div class="index-column">
							
							<h2 class="index-title">Protocol References</h2>
							<ul>
								
								<li><a href="Protocols/BCOVComponent.html">BCOVComponent</a></li>
								
								<li><a href="Protocols/BCOVComponentIdentity.html">BCOVComponentIdentity</a></li>
								
								<li><a href="Protocols/BCOVCuePoint.html">BCOVCuePoint</a></li>
								
								<li><a href="Protocols/BCOVFPSAuthorizationProxy.html">BCOVFPSAuthorizationProxy</a></li>
								
								<li><a href="Protocols/BCOVMutableAnalytics.html">BCOVMutableAnalytics</a></li>
								
								<li><a href="Protocols/BCOVMutableCuePoint.html">BCOVMutableCuePoint</a></li>
								
								<li><a href="Protocols/BCOVMutablePlaylist.html">BCOVMutablePlaylist</a></li>
								
								<li><a href="Protocols/BCOVMutableSource.html">BCOVMutableSource</a></li>
								
								<li><a href="Protocols/BCOVMutableVideo.html">BCOVMutableVideo</a></li>
								
								<li><a href="Protocols/BCOVOfflineVideoManagerDelegate.html">BCOVOfflineVideoManagerDelegate</a></li>
								
								<li><a href="Protocols/BCOVPUIButtonAccessibilityDelegate.html">BCOVPUIButtonAccessibilityDelegate</a></li>
								
								<li><a href="Protocols/BCOVPUIPlayerViewDelegate.html">BCOVPUIPlayerViewDelegate</a></li>
								
								<li><a href="Protocols/BCOVPlaybackController.html">BCOVPlaybackController</a></li>
								
								<li><a href="Protocols/BCOVPlaybackControllerAdsDelegate.html">BCOVPlaybackControllerAdsDelegate</a></li>
								
								<li><a href="Protocols/BCOVPlaybackControllerBasicDelegate.html">BCOVPlaybackControllerBasicDelegate</a></li>
								
								<li><a href="Protocols/BCOVPlaybackControllerDelegate.html">BCOVPlaybackControllerDelegate</a></li>
								
								<li><a href="Protocols/BCOVPlaybackSession.html">BCOVPlaybackSession</a></li>
								
								<li><a href="Protocols/BCOVPlaybackSessionAdsConsumer.html">BCOVPlaybackSessionAdsConsumer</a></li>
								
								<li><a href="Protocols/BCOVPlaybackSessionBasicConsumer.html">BCOVPlaybackSessionBasicConsumer</a></li>
								
								<li><a href="Protocols/BCOVPlaybackSessionConsumer.html">BCOVPlaybackSessionConsumer</a></li>
								
								<li><a href="Protocols/BCOVPlaybackSessionProvider.html">BCOVPlaybackSessionProvider</a></li>
								
								<li><a href="Protocols/BCOVPlaylist.html">BCOVPlaylist</a></li>
								
								<li><a href="Protocols/BCOVSource.html">BCOVSource</a></li>
								
								<li><a href="Protocols/BCOVTVPlayerViewDelegate.html">BCOVTVPlayerViewDelegate</a></li>
								
								<li><a href="Protocols/BCOVVideo.html">BCOVVideo</a></li>
								
							</ul>
							

							
							<h2 class="index-title">Constant References</h2>
							<ul>
								
									<li><a href="Constants/BCOVBufferOptimizerMethod.html">BCOVBufferOptimizerMethod</a></li>
								
									<li><a href="Constants/BCOVEconomics.html">BCOVEconomics</a></li>
								
									<li><a href="Constants/BCOVOfflineVideoDownloadState.html">BCOVOfflineVideoDownloadState</a></li>
								
									<li><a href="Constants/BCOVPUIButtonIcon.html">BCOVPUIButtonIcon</a></li>
								
									<li><a href="Constants/BCOVPUILearnMoreButtonBrowserStyle.html">BCOVPUILearnMoreButtonBrowserStyle</a></li>
								
									<li><a href="Constants/BCOVPUIScreenMode.html">BCOVPUIScreenMode</a></li>
								
									<li><a href="Constants/BCOVPUIVideo360NavigationMethod.html">BCOVPUIVideo360NavigationMethod</a></li>
								
									<li><a href="Constants/BCOVPUIViewTag.html">BCOVPUIViewTag</a></li>
								
									<li><a href="Constants/BCOVPlaybackServiceErrorCode.html">BCOVPlaybackServiceErrorCode</a></li>
								
									<li><a href="Constants/BCOVProgressPolicyCuePointsToProcess.html">BCOVProgressPolicyCuePointsToProcess</a></li>
								
									<li><a href="Constants/BCOVProgressPolicyResumePosition.html">BCOVProgressPolicyResumePosition</a></li>
								
									<li><a href="Constants/BCOVTVIconType.html">BCOVTVIconType</a></li>
								
									<li><a href="Constants/BCOVTVPlayerType.html">BCOVTVPlayerType</a></li>
								
									<li><a href="Constants/BCOVTVShowViewType.html">BCOVTVShowViewType</a></li>
								
									<li><a href="Constants/BCOVVideo360ProjectionStyle.html">BCOVVideo360ProjectionStyle</a></li>
								
									<li><a href="Constants/BCOVVideo360SourceFormat.html">BCOVVideo360SourceFormat</a></li>
								
									<li><a href="Constants/BCOVVideoType.html">BCOVVideoType</a></li>
								
							</ul>
							

							
							<h2 class="index-title">Category References</h2>
							<ul>
								
								<li><a href="Categories/NSDictionary-BCOVURLSupport.html">NSDictionary(BCOVURLSupport)</a></li>
								
							</ul>
							
						</div>
						
					</div>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">Copyright &copy; 2021 Brightcove. All rights reserved. Updated: 2021-07-08</p>
							
							
							<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1334)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="js/script.js"></script>
</body>
</html>
